"use strict";(self["webpackChunkyggdrasil_client"]=self["webpackChunkyggdrasil_client"]||[]).push([[704],{6749:function(t,e,a){var s=a(4161),l=a(2479);const i="http://localhost/api/v1/faculty/";class d{getAllFaculty(){return s.Z.get(i+"all",{headers:(0,l.Z)()})}getAllFacultySearch(t,e,a,d,n,o,r){let c=JSON.stringify({parameter:t,currentPage:e,sortField:a,sortDir:d,isActive:n,minDate:o,maxDate:r}),u={method:"post",maxBodyLength:1/0,url:i+"search/all",headers:(0,l.Z)(),data:c};return s.Z.request(u)}getAllActiveFaculty(){return s.Z.get(i+"active/all",{headers:(0,l.Z)()})}getFaculty(t){return s.Z.get(i+t,{headers:(0,l.Z)()})}updateFaculty(t,e,a,d){let n=JSON.stringify({id:Number(t),shortName:e,name:a,description:d}),o={method:"post",maxBodyLength:1/0,url:i+"update",headers:(0,l.Z)(),data:n};return s.Z.request(o)}createFaculty(t,e,a){let d=JSON.stringify({id:null,shortName:t,name:e,description:a}),n={method:"post",maxBodyLength:1/0,url:i+"create",headers:(0,l.Z)(),data:d};return s.Z.request(n)}}e["Z"]=new d},704:function(t,e,a){a.r(e),a.d(e,{default:function(){return lt}});var s=a(3396),l=a(7139),i=a(9242);const d={class:"chapter-name text-3xl mb-6"},n={class:"flex gap-x-5"},o={class:"menu w-1/5"},r={class:"w-4/5"},c={key:1,class:"faculty-body mb-10"},u={class:"menu-top mb-6 flex justify-between"},m=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,s._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 15.75L3 12m0 0l3.75-3.75M3 12h18"})],-1),p={class:"shadow-md rounded-xl overflow-hidden border p-5"},h={class:"faculty-data-top-menu flex justify-between mb-5"},y={class:"faculty-data-status"},x={key:0,class:"text-green-600"},f={key:1,class:"text-red-600"},g={class:"faculty-data-dates"},v={class:"faculty-data-dateCreate"},w={class:"faculty-data-dateUpdate"},b={class:"faculty-data-input"},k=(0,s._)("label",{for:"",class:"relative required"},"Короткое название:",-1),_=["disabled"],C={class:"faculty-data-input"},F=(0,s._)("label",{for:"",class:"relative required"},"Полное название:",-1),U=["disabled"],N={class:"faculty-data-input"},D=(0,s._)("label",{for:"",class:"relative"},"Описание:",-1),Z=["disabled"],L={class:"faculty-bottom-menu flex justify-end gap-5"},S=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,s._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"})],-1),j=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,s._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})],-1),A={key:2,class:"main-btn px-5 py-3 text-xl inline-flex items-center",type:"submit"},q=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,s._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})],-1),$={id:"updateFaculty",class:"modal modal-fixed-footer modalUpdateFaculty"},O=(0,s.uE)('<div class="modal-content flex flex-col"><div class="modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-[8rem]"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path></svg></div><div class="worn-text text-3xl text-red-700 mb-20 text-center">Внимание!</div><p class="text-2xl mb-3 text-center">Вы действительно хотите измененить данные факультета?</p></div>',1),E={class:"modal-footer flex justify-evenly"},B=(0,s._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Отмена",-1),T={id:"cancelUpdateFaculty",class:"modal modal-fixed-footer modalCancelUpdateFaculty"},z=(0,s.uE)('<div class="modal-content flex flex-col"><div class="modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-[8rem]"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path></svg></div><div class="worn-text text-3xl text-red-700 mb-20 text-center">Внимание!</div><p class="text-2xl mb-3 text-center">Вы действительно хотите отменить изменения данных факультета?</p></div>',1),H={class:"modal-footer flex justify-evenly"},I=(0,s._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Отмена",-1),R={class:"facylty-info"},V={class:"faculty-departments"},J=(0,s._)("div",{class:"facylty-departments-name text-2xl mb-3"}," Кафедры на факультете: ",-1),W={class:"facylty-users"},P=(0,s._)("div",{class:"facylty-users-name text-2xl mb-3"}," Сотрудники на факультете: ",-1);function Y(t,e,a,M,Y,G){const K=(0,s.up)("Sidebar"),Q=(0,s.up)("Loader"),X=(0,s.up)("MainTable");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",d," Факультет — "+(0,l.zw)(this.facultyShortName),1),(0,s._)("div",n,[(0,s._)("div",o,[(0,s.Wm)(K)]),(0,s._)("div",r,[this.loading?((0,s.wg)(),(0,s.j4)(Q,{key:0})):((0,s.wg)(),(0,s.iD)("div",c,[(0,s._)("div",u,[(0,s._)("button",{onClick:e[0]||(e[0]=(0,i.iM)(((...t)=>G.back&&G.back(...t)),["prevent"])),class:"main-btn py-3 px-5 inline-flex"},[m,(0,s.Uk)(" Вернуться ")])]),(0,s._)("div",p,[(0,s._)("div",h,[(0,s._)("div",y,[(0,s.Uk)(" Статус: "),this.isActive?((0,s.wg)(),(0,s.iD)("span",x,"Активный")):((0,s.wg)(),(0,s.iD)("span",f,"Деактивированный"))]),(0,s._)("div",g,[(0,s._)("div",v,"Дата создания: "+(0,l.zw)(this.$normaldate(this.dateCreate)),1),(0,s._)("div",w,"Дата обновления: "+(0,l.zw)(this.$normaldate(this.dateUpdate)),1)])]),(0,s._)("form",{action:"",class:"faculty-form",onSubmit:e[6]||(e[6]=(0,i.iM)(((...t)=>G.updateFacultyModel&&G.updateFacultyModel(...t)),["prevent"]))},[(0,s._)("div",b,[k,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e[1]||(e[1]=e=>t.facultyShortName=e),minlength:"1",required:"",type:"text",name:"",id:"",class:"input-text",placeholder:"Короткое название",title:"Введите короткое название",disabled:!this.updateMode},null,8,_),[[i.nr,t.facultyShortName,void 0,{trim:!0}]])]),(0,s._)("div",C,[F,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e[2]||(e[2]=e=>t.facultyName=e),minlength:"1",required:"",type:"text",name:"",id:"",class:"input-text",placeholder:"Полное название",title:"Введите полное название",disabled:!this.updateMode},null,8,U),[[i.nr,t.facultyName,void 0,{trim:!0}]])]),(0,s._)("div",N,[D,(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":e[3]||(e[3]=e=>t.facultyDescrition=e),name:"",id:"",class:"input-text h-36",placeholder:"Описание",maxlength:"255",title:"Введите описание",disabled:!this.updateMode},null,8,Z),[[i.nr,t.facultyDescrition,void 0,{trim:!0}]])]),(0,s._)("div",L,[this.updateMode?this.updateMode?((0,s.wg)(),(0,s.iD)("button",{key:1,class:"main-btn-red px-5 py-3 text-xl inline-flex items-center",onClick:e[5]||(e[5]=(0,i.iM)(((...t)=>G.rajectChangesModal&&G.rajectChangesModal(...t)),["prevent"]))},[j,(0,s.Uk)(" Отменить ")])):(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:0,class:"main-btn px-5 py-3 text-xl inline-flex items-center",onClick:e[4]||(e[4]=(0,i.iM)(((...t)=>G.changeOperationMode&&G.changeOperationMode(...t)),["prevent"]))},[S,(0,s.Uk)(" Редактировать ")])),this.updateMode?((0,s.wg)(),(0,s.iD)("button",A,[q,(0,s.Uk)(" Сохранить ")])):(0,s.kq)("",!0)])],32)])])),(0,s._)("div",$,[O,(0,s._)("div",E,[(0,s._)("button",{class:"main-btn inline-block px-5 py-3 w-[150px] text-center text-xl",onClick:e[7]||(e[7]=(...t)=>G.updateFaculty&&G.updateFaculty(...t))},"Да"),B])]),(0,s._)("div",T,[z,(0,s._)("div",H,[(0,s._)("button",{class:"main-btn-yellow inline-block px-5 py-3 w-[150px] text-center text-xl",onClick:e[8]||(e[8]=(...t)=>G.rajectChanges&&G.rajectChanges(...t))},"Да"),I])]),(0,s._)("div",R,[(0,s._)("div",V,[J,(0,s.Wm)(X,{header:t.departmentsHeader,content:t.departmentsContent,noDataMessage:t.noDepatmentsMessage},null,8,["header","content","noDataMessage"])]),(0,s._)("div",W,[P,(0,s.Wm)(X,{header:t.usersHeader,content:t.usersContent,noDataMessage:t.noUsersMessage},null,8,["header","content","noDataMessage"])])])])])],64)}a(7658);var G=a(2435),K=a(6270),Q=a(6749),X=a(6833),tt=a(9117),et={name:"Faculty",props:["facultyId"],data:()=>({loading:!0,modalUpdateFaculty:null,modalCancelUpdateFaculty:null,updateMode:!1,facultyShortName:"",facultyName:"",facultyDescrition:"",isActive:"",departments:[],users:[],dateCreate:"",dateUpdate:"",message:"",departmentsHeader:["№ кафедры","Наименование","Стату","Дата создания",""],noDepatmentsMessage:"Кафедры на факультете не найдены",departmentsContent:[],usersHeader:["№ сотрудника","ФИО","Роль","Кафедра","Статус","Штатный","Дата создания",""],noUsersMessage:"Сотрудники на факультете не найдены",usersContent:[]}),validations(){return{facultyShortName:{required:tt.C1,minLength:(0,tt.Ei)(1)},facultyName:{required:tt.C1,minLength:(0,tt.Ei)(1)},facultyDescrition:{minLength:(0,tt.Ei)(0)}}},async mounted(){K.Z[this.$route.query.message]&&this.$message(K.Z[this.$route.query.message]),await Q.Z.getFaculty(this.facultyId).then((t=>{this.facultyShortName=t.data.shortName,this.facultyName=t.data.name,this.facultyDescrition=t.data.description,this.isActive=t.data.isActive,this.departments=t.data.departments,this.dateCreate=t.data.dateCreate,this.dateUpdate=t.data.dateUpdate;for(let e of this.departments)this.users.push(...e.users);for(const e of this.users)"ROLE_ADMIN"!==e.roles[0].name&&"ROLE_SUPER_ADMIN"!==e.roles[0].name&&this.usersContent.push([{type:"id",text:e.id},{type:"text",text:e.lastName+" "+e.name+" "+e.patronymic,shortTest:e.lastName+" "+e.name[0]+". "+e.patronymic[0]+"."},{type:"onlyText",text:"ROLE_MODERATOR"===e.roles[0].name?"Зав. кафедрой":"Преподаватель"},{type:"text",text:e.department.name,shortTest:e.department.shortName},{type:"status",text:e.isActive?"Активный":"Деактивированный"},{type:"date",text:e.dateCreate},{type:"link",text:"Подробнее",link:"/employees/"+e.id}]);for(const e of this.departments)this.departmentsContent.push([{type:"id",text:e.id},{type:"text",text:e.name,shortTest:e.shortName},{type:"status",text:e.isActive?"Активный":"Деактивированный"},{type:"date",text:e.dateCreate},{type:"link",text:"Подробнее",link:"/department/"+e.id}])}),(t=>{this.message=t.response&&t.response.data&&t.response.data.message||t.message||t.toString(),this.$error(K.Z[this.message]||"Что-то пошло не так")})),setTimeout((()=>{this.modalUpdateFaculty=M.Modal.init(document.querySelector(".modalUpdateFaculty"),{}),this.modalCancelUpdateFaculty=M.Modal.init(document.querySelector(".modalCancelUpdateFaculty"),{})}),0),this.loading=!1},methods:{changeOperationMode(){this.updateMode=!0,this.$message("Включен режим редактирования")},rajectChanges(){this.modalCancelUpdateFaculty.close(),this.updateMode=!1,this.loading=!0,this.$message("Отмена изменений"),setTimeout((()=>{window.location.reload()}),1300)},rajectChangesModal(){this.modalCancelUpdateFaculty.open()},updateFacultyModel(){""!==this.facultyShortName&&""!==this.facultyName?this.modalUpdateFaculty.open():this.$error("Заполните все обязательные поля")},async updateFaculty(){this.loading=!0,this.modalUpdateFaculty.close(),await Q.Z.updateFaculty(this.facultyId,this.facultyShortName,this.facultyName,this.facultyDescrition),await Q.Z.getFaculty(this.facultyId).then((t=>{this.facultyShortName=t.data.shortName,this.facultyName=t.data.name,this.facultyDescrition=t.data.description,this.isActive=t.data.isActive,this.departments=t.data.departments,this.dateCreate=t.data.dateCreate,this.dateUpdate=t.data.dateUpdate;for(let e of this.departments)this.users.push(...e.users)}),(t=>{this.message=t.response&&t.response.data&&t.response.data.message||t.message||t.toString(),this.$error(K.Z[this.message]||"Что-то пошло не так")})),this.updateMode=!1,this.loading=!1,this.$message("Факультет обновлен")},back(){this.$router.go(-1)}},beforeDestroy(){this.modalUpdateFaculty&&this.modalUpdateFaculty.destroy&&this.modalUpdateFaculty.destroy(),this.modalCancelUpdateFaculty&&this.modalCancelUpdateFaculty.destroy&&this.modalCancelUpdateFaculty.destroy()},components:{Sidebar:G.Z,MainTable:X.Z}},at=a(89);const st=(0,at.Z)(et,[["render",Y]]);var lt=st}}]);
//# sourceMappingURL=704.ee324eff.js.map