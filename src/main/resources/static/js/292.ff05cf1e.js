"use strict";(self["webpackChunkyggdrasil_client"]=self["webpackChunkyggdrasil_client"]||[]).push([[292],{5753:function(e,t,a){var i=a(4161),s=a(2479),l=a(3456);const r="http://10.100.124.9/api/v1/user/";class o{getUserInfo(){return i.Z.get(r+this.currentUser().username,{headers:(0,s.Z)()})}getEmployeeInfo(e){return i.Z.get(r+`profile/${e}/info`,{headers:(0,s.Z)()})}getUserFaculty(e){return i.Z.get(r+`${e}/faculty`,{headers:(0,s.Z)()})}getUserDepartment(e){return i.Z.get(r+`${e}/department`,{headers:(0,s.Z)()})}userTokenCheck(){return console.log((0,s.Z)()),i.Z.get(r+"token/check",{headers:(0,s.Z)()})}getAllUsers(){return i.Z.get(r+"list",{headers:(0,s.Z)()})}getAllDepartmentUsers(){return i.Z.get(r+"department/list",{headers:(0,s.Z)()})}getAllUsersFind(e,t,a,l,o,n,d,c,m,p){let h=JSON.stringify({parameter:e,currentPage:t,sortField:a,sortDir:l,minDate:o,maxDate:n,departmentName:d,isState:c,userRole:m,isActive:p}),u={method:"post",maxBodyLength:1/0,url:r+"list/find",headers:(0,s.Z)(),data:h};return i.Z.request(u)}updateProfile(e,t,a,l,o,n,d,c,m,p,h,u,g,f,x){let v=JSON.stringify({id:e,phone:t,email:a,imgUrl:l,lastName:o,name:n,patronymic:d,jobTitle:c,academicTitle:m,academicDegree:p,orcid:h,spinCode:u,birthday:g,state:f,departmentId:x}),b={method:"post",maxBodyLength:1/0,url:r+"update",headers:(0,s.Z)(),data:v};return i.Z.request(b)}checkValidUsername(e){let t=JSON.stringify({username:e}),a={method:"post",maxBodyLength:1/0,url:r+"username/check",headers:(0,s.Z)(),data:t};return i.Z.request(a)}createUser(e,t,a,l,o,n,d,c){let m=JSON.stringify({lastName:e,name:t,patronymic:a,state:l,departmentId:Number(o),username:n,password:d,userRole:c}),p={method:"post",maxBodyLength:1/0,url:r+"create",headers:(0,s.Z)(),data:m};return i.Z.request(p)}updateUserStatus(e,t){let a=JSON.stringify({userId:Number(e),isActive:t}),l={method:"post",maxBodyLength:1/0,url:r+"status/update",headers:(0,s.Z)(),data:a};return i.Z.request(l)}updateUserPassword(e,t){let a=JSON.stringify({userId:Number(e),password:t}),l={method:"post",maxBodyLength:1/0,url:r+"password/update",headers:(0,s.Z)(),data:a};return i.Z.request(l)}currentUser(){return l.Z.state.auth.user}}t["Z"]=new o},2435:function(e,t,a){a.d(t,{Z:function(){return m}});var i=a(3396),s=a(7139);const l={class:"shadow-md rounded-xl overflow-hidden border"};function r(e,t,a,r,o,n){const d=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("ul",l,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.links,(e=>((0,i.wg)(),(0,i.iD)("li",{key:e.url},[e.roles.includes(this.currentUser.roles[0])?((0,i.wg)(),(0,i.j4)(d,{key:0,"active-class":"active",to:e.url,class:"hover:bg-gray-200 pl-5 py-2 block select-none"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(e.title),1)])),_:2},1032,["to"])):(0,i.kq)("",!0)])))),128))])}var o=a(8806),n={data:()=>({links:[{title:"Документы",url:"/documents",roles:[o.v.User,o.v.Admin,o.v.Moderator]},{title:"Отчеты",url:"/reports",roles:[o.v.Admin,o.v.Moderator]},{title:"Факультеты",url:"/facultets",roles:[o.v.SuperAdmin]},{title:"Кафедры",url:"/departments",roles:[o.v.SuperAdmin]},{title:"Сотрудники",url:"/employees",roles:[o.v.SuperAdmin,o.v.Moderator]},{title:"Студенты",url:"/students",roles:[o.v.User,o.v.SuperAdmin,o.v.Moderator]},{title:"Конструктор шаблонов",url:"/constructors",roles:[o.v.SuperAdmin]},{title:"Статистика",url:"/statistics",roles:[o.v.User,o.v.Admin,o.v.Moderator]},{title:"Разное",url:"/different",roles:[o.v.SuperAdmin]}]}),computed:{currentUser(){return this.$store.state.auth.user}}},d=a(89);const c=(0,d.Z)(n,[["render",r]]);var m=c},6292:function(e,t,a){a.r(t),a.d(t,{default:function(){return _e}});var i=a(3396),s=a(9242),l=a(7139);const r=(0,i._)("div",{class:"chapter-name text-3xl mb-6"}," Профиль ",-1),o={class:"flex gap-x-5 mb-6"},n={class:"menu w-1/5"},d={class:"w-4/5"},c={class:"profile-data mb-10"},m={class:"profile-top-data-section flex gap-3"},p={class:"profile-left-data w-1/2 relative"},h=(0,i._)("div",{class:"profile-img text-[var(--color-main)]"},[(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-72 h-72 mx-auto my-7"},[(0,i._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"})])],-1),u={key:0,class:"profile-state absolute left-0 top-0 text-[var(--color-main)] text-lg select-none"},g={key:1,class:"profile-state absolute left-0 top-0 text-[var(--color-main)] text-lg select-none"},f={key:2,class:"profile-state absolute left-0 top-0 text-[var(--color-main)] text-lg select-none"},x={class:"profile-right-data profile-data-group flex flex-col w-1/2 justify-between"},v={class:"profile-data-input"},b=(0,i._)("label",{for:"",class:"relative required"},"Фамилия:",-1),w=["disabled"],y={class:"profile-data-input"},_=(0,i._)("label",{for:"",class:"relative required"},"Имя:",-1),k=["disabled"],U={class:"profile-data-input"},C=(0,i._)("label",{for:"",class:"relative required"},"Отчество:",-1),Z=["disabled"],D={class:"profile-data-input"},L=(0,i._)("label",{for:""},"Дата рождения:",-1),P=["disabled"],S={class:"profile-bottom-data-section"},j={class:"profile-data-input mb-2"},E=(0,i._)("label",{for:""},"Ученое звание:",-1),T=["disabled"],A={class:"profile-data-input mb-2"},q=(0,i._)("label",{for:""},"Ученая степень:",-1),$=["disabled"],N={class:"profile-data-group flex gap-5"},O={class:"profile-data-input flex-grow"},I=(0,i._)("label",{for:""},"Email:",-1),V=["disabled"],B={class:"profile-data-input flex-grow"},R=(0,i._)("label",{for:""},"Телефон:",-1),z=["disabled"],J={class:"profile-data-group flex gap-5"},F={class:"profile-data-input flex-grow"},H=(0,i._)("label",{for:""},"Должность:",-1),Y=["disabled"],K={class:"profile-data-input flex-grow"},W=(0,i._)("label",{for:""},"ORCID:",-1),G=["disabled"],Q={class:"profile-data-input flex-grow"},X=(0,i._)("label",{for:""},"Spin Code:",-1),ee=["disabled"],te={class:"profile-ponel flex justify-end gap-5"},ae=(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,i._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"})],-1),ie=(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,i._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})],-1),se={key:2,class:"main-btn px-5 py-3 text-xl inline-flex items-center",type:"submit"},le=(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,i._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})],-1),re={id:"updateProfile",class:"modal modal-fixed-footer modalUpdateProfile"},oe=(0,i.uE)('<div class="modal-content flex flex-col"><div class="modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-[8rem]"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path></svg></div><div class="worn-text text-3xl text-red-700 mb-20 text-center">Внимание!</div><p class="text-2xl mb-3 text-center">Вы действительно хотите измененить данные профиля?</p></div>',1),ne={class:"modal-footer flex justify-evenly"},de=(0,i._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Отмена",-1),ce={id:"cancelUpdateProfile",class:"modal modal-fixed-footer modalCancelUpdateProfile"},me=(0,i.uE)('<div class="modal-content flex flex-col"><div class="modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-[8rem]"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path></svg></div><div class="worn-text text-3xl text-red-700 mb-20 text-center">Внимание!</div><p class="text-2xl mb-3 text-center">Вы действительно хотите отменить изменения данных профиля?</p></div>',1),pe={class:"modal-footer flex justify-evenly"},he=(0,i._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Отмена",-1);function ue(e,t,a,M,ue,ge){const fe=(0,i.up)("Sidebar"),xe=(0,i.up)("Loader");return(0,i.wg)(),(0,i.iD)(i.HY,null,[r,(0,i._)("div",o,[(0,i._)("div",n,[(0,i.Wm)(fe)]),(0,i._)("div",d,[this.loading?((0,i.wg)(),(0,i.j4)(xe,{key:0})):((0,i.wg)(),(0,i.iD)("form",{key:1,action:"",onSubmit:t[13]||(t[13]=(0,s.iM)(((...e)=>ge.updateProfileModel&&ge.updateProfileModel(...e)),["prevent"])),class:"shadow-md rounded-xl overflow-hidden border p-5"},[(0,i._)("div",c,[(0,i._)("div",m,[(0,i._)("div",p,[h,"ROLE_SUPER_ADMIN"!==this.$store.state.auth.user.roles[0]&&"ROLE_ADMIN"!==this.$store.state.auth.user.roles[0]?((0,i.wg)(),(0,i.iD)("div",u,(0,l.zw)(e.content.state?"Штатный":"Совместитель")+" — "+(0,l.zw)(e.faculty.shortName)+" — "+(0,l.zw)(e.department.shortName),1)):"ROLE_SUPER_ADMIN"===this.$store.state.auth.user.roles[0]?((0,i.wg)(),(0,i.iD)("div",g,"Технический Администратор")):"ROLE_ADMIN"===this.$store.state.auth.user.roles[0]?((0,i.wg)(),(0,i.iD)("div",f,"Администратор")):(0,i.kq)("",!0)]),(0,i._)("div",x,[(0,i._)("div",v,[b,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.lastname=t),minlength:"1",maxlength:"50",required:"",type:"text",name:"",id:"",class:"input-text",placeholder:"Фамилия",title:"Введите фамилию",disabled:!this.updateMode},null,8,w),[[s.nr,e.lastname,void 0,{trim:!0}]])]),(0,i._)("div",y,[_,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.name=t),minlength:"1",maxlength:"50",required:"",type:"text",name:"",id:"",class:"input-text",placeholder:"Имя",title:"Введите имя",disabled:!this.updateMode},null,8,k),[[s.nr,e.name,void 0,{trim:!0}]])]),(0,i._)("div",U,[C,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.patronymic=t),minlength:"1",maxlength:"50",required:"",type:"text",name:"",id:"",class:"input-text",placeholder:"Отчество",title:"Введите отчество",disabled:!this.updateMode},null,8,Z),[[s.nr,e.patronymic,void 0,{trim:!0}]])]),(0,i._)("div",D,[L,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.birthday=t),type:"date",name:"",id:"",class:"input-text",placeholder:"Дата рождения",title:"Введите дату рождения",disabled:!this.updateMode},null,8,P),[[s.nr,e.birthday,void 0,{trim:!0}]])])])]),(0,i._)("div",S,[(0,i._)("div",j,[E,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[4]||(t[4]=t=>e.academicTitle=t),type:"text",maxlength:"255",name:"",id:"",class:"input-text",placeholder:"Ученое звание",title:"Введите ученое звание",disabled:!this.updateMode},null,8,T),[[s.nr,e.academicTitle,void 0,{trim:!0}]])]),(0,i._)("div",A,[q,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.academicDegree=t),type:"text",maxlength:"255",name:"",id:"",class:"input-text",placeholder:"Ученая степень",title:"Введите ученую степень",disabled:!this.updateMode},null,8,$),[[s.nr,e.academicDegree,void 0,{trim:!0}]])]),(0,i._)("div",N,[(0,i._)("div",O,[I,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[6]||(t[6]=t=>e.email=t),type:"email",maxlength:"100",name:"",id:"",class:"input-text",placeholder:"Email",title:"Введите Email",disabled:!this.updateMode},null,8,V),[[s.nr,e.email,void 0,{trim:!0}]])]),(0,i._)("div",B,[R,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[7]||(t[7]=t=>e.phone=t),minlength:"11",maxlength:"11",type:"tel",name:"",id:"",class:"input-text",placeholder:"Телефон",title:"Введите номер телефона без (+)",disabled:!this.updateMode},null,8,z),[[s.nr,e.phone,void 0,{trim:!0}]])])]),(0,i._)("div",J,[(0,i._)("div",F,[H,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[8]||(t[8]=t=>e.jobTitle=t),type:"text",maxlength:"100",name:"",id:"",class:"input-text",placeholder:"Должность",title:"Введите должность",disabled:!this.updateMode},null,8,Y),[[s.nr,e.jobTitle,void 0,{trim:!0}]])]),(0,i._)("div",K,[W,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[9]||(t[9]=t=>e.orcid=t),type:"text",maxlength:"50",name:"",id:"",class:"input-text",placeholder:"ORCID",title:"Введите ORCID",disabled:!this.updateMode},null,8,G),[[s.nr,e.orcid,void 0,{trim:!0}]])]),(0,i._)("div",Q,[X,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[10]||(t[10]=t=>e.spinCode=t),type:"text",maxlength:"50",name:"",id:"",class:"input-text",placeholder:"Spin Code",title:"Введите Spin Code",disabled:!this.updateMode},null,8,ee),[[s.nr,e.spinCode,void 0,{trim:!0}]])])])])]),(0,i._)("div",te,[this.updateMode?this.updateMode?((0,i.wg)(),(0,i.iD)("button",{key:1,class:"main-btn-red px-5 py-3 text-xl inline-flex items-center",onClick:t[12]||(t[12]=(0,s.iM)(((...e)=>ge.rajectChangesModal&&ge.rajectChangesModal(...e)),["prevent"]))},[ie,(0,i.Uk)(" Отменить ")])):(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("button",{key:0,class:"main-btn px-5 py-3 text-xl inline-flex items-center",onClick:t[11]||(t[11]=(0,s.iM)(((...e)=>ge.changeOperationMode&&ge.changeOperationMode(...e)),["prevent"]))},[ae,(0,i.Uk)(" Редактировать ")])),this.updateMode?((0,i.wg)(),(0,i.iD)("button",se,[le,(0,i.Uk)(" Сохранить ")])):(0,i.kq)("",!0)])],32))]),(0,i._)("div",re,[oe,(0,i._)("div",ne,[(0,i._)("button",{class:"main-btn inline-block px-5 py-3 w-[150px] text-center text-xl",onClick:t[14]||(t[14]=(...e)=>ge.updateProfile&&ge.updateProfile(...e))},"Да"),de])]),(0,i._)("div",ce,[me,(0,i._)("div",pe,[(0,i._)("button",{class:"main-btn-yellow inline-block px-5 py-3 w-[150px] text-center text-xl",onClick:t[15]||(t[15]=(...e)=>ge.rajectChanges&&ge.rajectChanges(...e))},"Да"),he])])])],64)}var ge=a(2435),fe=a(5753),xe=a(6270),ve=a(9117),be={name:"DocumentsView",data:()=>({loading:!0,content:"",faculty:"",department:"",message:"",updateMode:!1,modalUpdateProfile:null,modalCancelUpdateProfile:null,patronymic:"",name:"",lastname:"",birthday:"",academicTitle:"",academicDegree:"",email:"",phone:"",jobTitle:"",orcid:"",spinCode:"",imgUrl:""}),validations(){return{patronymic:{required:ve.C1,minLength:(0,ve.Ei)(1)},name:{required:ve.C1,minLength:(0,ve.Ei)(1)},lastname:{required:ve.C1,minLength:(0,ve.Ei)(1)},birthday:{minLength:(0,ve.Ei)(0)},academicTitle:{minLength:(0,ve.Ei)(0)},academicDegree:{minLength:(0,ve.Ei)(0)},email:{email:ve.Do,minLength:(0,ve.Ei)(0)},phone:{integer:integer,minLength:(0,ve.Ei)(11),maxlength:(0,ve.BS)(11)},jobTitle:{minLength:(0,ve.Ei)(0)},orcid:{integer:integer,minLength:(0,ve.Ei)(0)},spinCode:{integer:integer,minLength:(0,ve.Ei)(0)}}},async mounted(){await fe.Z.getUserInfo().then((e=>{this.content=e.data,this.lastname=this.content.lastname,this.name=this.content.name,this.patronymic=this.content.patronymic,this.birthday=this.content.birthday,this.academicTitle=this.content.academicTitle,this.academicDegree=this.content.academicDegree,this.email=this.content.email,this.phone=this.content.phone,this.jobTitle=this.content.jobTitle,this.orcid=this.content.orcid,this.spinCode=this.content.spinCode}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(xe.Z[this.message]||"Что-то пошло не так")})),await fe.Z.getUserFaculty(this.$store.state.auth.user.username).then((e=>{this.faculty=e.data}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(xe.Z[this.message]||"Что-то пошло не так")})),await fe.Z.getUserDepartment(this.$store.state.auth.user.username).then((e=>{this.department=e.data}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(xe.Z[this.message]||"Что-то пошло не так")})).finally(this.loading=!1),setTimeout((()=>{this.modalUpdateProfile=M.Modal.init(document.querySelector(".modalUpdateProfile"),{}),this.modalCancelUpdateProfile=M.Modal.init(document.querySelector(".modalCancelUpdateProfile"),{})}))},methods:{changeOperationMode(){this.updateMode=!0,this.$message("Включен режим редактирования")},rajectChanges(){this.modalCancelUpdateProfile.close(),this.updateMode=!1,this.loading=!0,this.$message("Отмена изменений"),setTimeout((()=>{window.location.reload()}),1300)},rajectChangesModal(){this.modalCancelUpdateProfile.open()},updateProfileModel(){""!==this.lastname&&""!==this.name&&""!==this.patronymic?this.modalUpdateProfile.open():this.$error("Заполните все обязательные поля")},async updateProfile(){this.loading=!0,this.modalUpdateProfile.close(),await fe.Z.updateProfile(this.$store.state.auth.user.id,this.phone,this.email,this.imgUrl,this.lastname,this.name,this.patronymic,this.jobTitle,this.academicTitle,this.academicDegree,this.orcid,this.spinCode,this.birthday,this.content.state,this.department.id),await fe.Z.getUserInfo().then((e=>{this.content=e.data,this.lastname=this.content.lastname,this.name=this.content.name,this.patronymic=this.content.patronymic,this.birthday=this.content.birthday,this.academicTitle=this.content.academicTitle,this.academicDegree=this.content.academicDegree,this.email=this.content.email,this.phone=this.content.phone,this.jobTitle=this.content.jobTitle,this.orcid=this.content.orcid,this.spinCode=this.content.spinCode}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(xe.Z[this.message]||"Что-то пошло не так")})),this.updateMode=!1,this.loading=!1,this.$message("Профиль обновлен")}},beforeDestroy(){this.modalUpdateProfile&&this.modalUpdateProfile.destroy&&this.modalUpdateProfile.destroy(),this.modalCancelUpdateProfile&&this.modalCancelUpdateProfile.destroy&&this.modalCancelUpdateProfile.destroy()},components:{Sidebar:ge.Z}},we=a(89);const ye=(0,we.Z)(be,[["render",ue]]);var _e=ye}}]);
//# sourceMappingURL=292.ff05cf1e.js.map