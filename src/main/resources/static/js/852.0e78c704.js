"use strict";(self["webpackChunkyggdrasil_client"]=self["webpackChunkyggdrasil_client"]||[]).push([[852],{8548:function(e,t,s){var a=s(4161),i=s(2479),o=s(3456);const n="http://10.100.124.9/api/v1/students/";class l{getAllStudent(e,t,s,o,l,d,r,c){let u=JSON.stringify({parameter:e,currentPage:t,sortField:s,sortDir:o,minDate:l,maxDate:d,departmentName:r,isActive:c}),m={method:"post",maxBodyLength:1/0,url:n+"all",headers:(0,i.Z)(),data:u};return a.Z.request(m)}getAllFacultyStudent(e,t,s,o,l,d,r,c,u){let m=JSON.stringify({parameter:e,currentPage:t,sortField:s,sortDir:o,minDate:l,maxDate:d,departmentName:r,isActive:c,facultyId:u}),h={method:"post",maxBodyLength:1/0,url:n+"faculty/all",headers:(0,i.Z)(),data:m};return a.Z.request(h)}getAllDepartmentStudent(e,t,s,o,l,d,r,c,u){let m=JSON.stringify({parameter:e,currentPage:t,sortField:s,sortDir:o,minDate:l,maxDate:d,departmentName:r,isActive:c,departmentId:u}),h={method:"post",maxBodyLength:1/0,url:n+"department/all",headers:(0,i.Z)(),data:m};return a.Z.request(h)}createStudent(e,t,s,o,l,d,r,c,u,m){let h=JSON.stringify({lastName:e,name:t,patronymic:s,groupName:o,departmentId:l,yearStart:d,yearEnd:r,email:c,phone:u,birthday:m}),p={method:"post",maxBodyLength:1/0,url:n+"create",headers:(0,i.Z)(),data:h};return a.Z.request(p)}getStudent(e){return a.Z.get(n+e,{headers:(0,i.Z)()})}updateStudent(e,t,s,o,l,d,r,c,u,m,h){let p=JSON.stringify({studentId:e,lastName:t,name:s,patronymic:o,groupName:l,departmentId:d,yearStart:r,yearEnd:c,email:u,phone:m,birthday:h}),g={method:"post",maxBodyLength:1/0,url:n+"update",headers:(0,i.Z)(),data:p};return a.Z.request(g)}getAllForDocumentStudent(){return a.Z.get(n+"document/all",{headers:(0,i.Z)()})}updateStudentStatus(e,t){let s=JSON.stringify({studentId:e,isTrained:t}),o={method:"post",maxBodyLength:1/0,url:n+"status/update",headers:(0,i.Z)(),data:s};return a.Z.request(o)}currentUser(){return o.Z.state.auth.user}}t["Z"]=new l},3852:function(e,t,s){s.r(t),s.d(t,{default:function(){return Zt}});var a=s(3396),i=s(7139),o=s(9242);const n={class:"chapter-name text-3xl mb-6"},l={class:"flex gap-x-5 flex-grow"},d={class:"menu w-1/5"},r={class:"w-4/5 flex flex-col mb-6"},c={class:"menu-top mb-6 flex justify-between"},u=(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 15.75L3 12m0 0l3.75-3.75M3 12h18"})],-1),m=["data-target"],h=(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 15.75L3 12m0 0l3.75-3.75M3 12h18"})],-1),p={id:"myModel",class:"modal modal-fixed-footer"},g=(0,a.uE)('<div class="modal-content flex flex-col"><div class="modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-[8rem]"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path></svg></div><div class="worn-text text-3xl text-red-700 mb-20 text-center">Внимание!</div><p class="text-2xl mb-3 text-center">При уходе с этой страницы измененные поля не будет сохранены!</p></div>',1),f={class:"modal-footer flex justify-evenly"},k=(0,a._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Остаться",-1),x=["disabled"],D=(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})],-1),y={id:"modelDelete",class:"modal modal-fixed-footer"},v={class:"modal-content flex flex-col"},b=(0,a._)("div",{class:"modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"},[(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-[8rem]"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})])],-1),w=(0,a._)("div",{class:"worn-text text-3xl text-red-700 mb-20 text-center"},"Внимание!",-1),S={class:"text-2xl mb-3 text-center"},_={class:"modal-footer flex justify-evenly"},C=(0,a._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Отмена",-1);function R(e,t,s,M,R,F){const I=(0,a.up)("FullScreenLoader"),j=(0,a.up)("Sidebar"),$=(0,a.up)("router-link"),L=(0,a.up)("DocumentGenerator");return(0,a.wg)(),(0,a.iD)(a.HY,null,[this.loading?((0,a.wg)(),(0,a.j4)(I,{key:0})):(0,a.kq)("",!0),(0,a._)("div",n," Просмотр документа — №"+(0,i.zw)(this.documentId),1),(0,a._)("div",l,[(0,a._)("div",d,[(0,a.Wm)(j)]),(0,a._)("div",r,[(0,a._)("div",c,[this.modified?((0,a.wg)(),(0,a.iD)("button",{key:1,class:"modal-trigger main-btn py-3 px-5 inline-flex","data-target":this.modified?"myModel":""},[h,(0,a.Uk)(" Вернуться ")],8,m)):((0,a.wg)(),(0,a.iD)("button",{key:0,class:"main-btn py-3 px-5 inline-flex",onClick:t[0]||(t[0]=(0,o.iM)(((...e)=>F.goBack&&F.goBack(...e)),["prevent"]))},[u,(0,a.Uk)(" Вернуться ")])),(0,a._)("div",p,[g,(0,a._)("div",f,[(0,a.Wm)($,{to:{name:"documents"},class:"main-btn inline-block px-5 py-3 w-[150px] text-center text-xl"},{default:(0,a.w5)((()=>[(0,a.Uk)("Уйти")])),_:1}),k])]),(0,a._)("button",{class:"modal-trigger flex main-btn-red py-3 px-5","data-target":"modelDelete",disabled:0==this.canDelete||"ROLE_ADMIN"===this.$store.state.auth.user.roles[0]},[D,(0,a.Uk)(" Удалить ")],8,x),(0,a._)("div",y,[(0,a._)("div",v,[b,w,(0,a._)("p",S,"Вы действительно хотите удалить документ №"+(0,i.zw)(this.documentId)+"?",1)]),(0,a._)("div",_,[(0,a._)("button",{class:"main-btn-red inline-block px-5 py-3 w-[150px] text-center text-xl",onClick:t[1]||(t[1]=(...e)=>F.deleteDocument&&F.deleteDocument(...e))},"Да"),C])])]),((0,a.wg)(),(0,a.j4)(L,{documentId:this.documentId,onUpdateParent:F.onUpdateModified,key:this.komponentKey},null,8,["documentId","onUpdateParent"]))])])],64)}s(7658);var F=s(2435);const I={class:"documentGenerator-controller mb-5 flex justify-end"},j=["disabled"],$=(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.5 15h2.25m8.024-9.75c.011.05.028.1.052.148.591 1.2.924 2.55.924 3.977a8.96 8.96 0 01-.999 4.125m.023-8.25c-.076-.365.183-.75.575-.75h.908c.889 0 1.713.518 1.972 1.368.339 1.11.521 2.287.521 3.507 0 1.553-.295 3.036-.831 4.398C20.613 14.547 19.833 15 19 15h-1.053c-.472 0-.745-.556-.5-.96a8.95 8.95 0 00.303-.54m.023-8.25H16.48a4.5 4.5 0 01-1.423-.23l-3.114-1.04a4.5 4.5 0 00-1.423-.23H6.504c-.618 0-1.217.247-1.605.729A11.95 11.95 0 002.25 12c0 .434.023.863.068 1.285C2.427 14.306 3.346 15 4.372 15h3.126c.618 0 .991.724.725 1.282A7.471 7.471 0 007.5 19.5a2.25 2.25 0 002.25 2.25.75.75 0 00.75-.75v-.633c0-.573.11-1.14.322-1.672.304-.76.93-1.33 1.653-1.715a9.04 9.04 0 002.86-2.4c.498-.634 1.226-1.08 2.032-1.08h.384"})],-1),L={class:"structure-info mb-6"},q={key:0,class:"structure-info-message px-3 py-6 text-center text-yellow-600 rounded-lg border-yellow-600 border-2 mb-6 text-lg"},O={class:"document-info flex justify-between"},U={class:"document-info-left"},N={key:0,class:"document-status text-lg mb-3"},A={class:"inline-block text-white bg-green-700 py-1 px-3 rounded-lg"},B={key:1,class:"document-status text-lg"},z={class:"inline-block text-white bg-red-700 py-1 px-3 rounded-lg"},Z={key:2,class:"document-status text-lg"},K={class:"inline-block text-white bg-yellow-600 py-1 px-3 rounded-lg"},P={key:3,class:"document-status text-lg"},H={class:"inline-block text-white bg-gray-500 py-1 px-3 rounded-lg"},W={class:"document-type text-lg mb-3"},J={class:"document-owner text-lg mb-3"},T={class:"inline-block py-1 px-3 rounded-lg bg-[var(--color-main)] text-white"},V={class:"document-info-right"},Y={class:"document-owner text-lg mb-1"},E={class:"document-owner text-lg"},G={class:"structure-name text-2xl mb-3"},Q={class:"structure-description text-xl"},X={class:"documentGenerator flex-grow flex"},ee={key:1,action:"",class:"createForm flex-grow border rounded-xl shadow-md overflow-hidden py-3 px-5 mb-6 flex-col flex"},te={class:"formField"},se=(0,a._)("div",{class:"formField-name mb-1 ml-5 relative"},"Ключевые слова:",-1),ae=(0,a._)("div",{class:"formField-description mt-1"},"Укажите ключевые слова (для добавления слов необходимо выбрать их из выпадающего списка или ввести с клавиатуры и нажать enter).",-1),ie=["disabled","id","minlength","maxlength","placeholder","value"],oe=["disabled","id","min","max","step","value","placeholder"],ne=["min","max","disabled","id","value","placeholder"],le=["id"],de=["disabled"],re={value:"",disabled:""},ce=["value","selected"],ue=["id"],me=["disabled"],he={value:"",disabled:""},pe=["value","selected"],ge=["id"],fe=["disabled"],ke={value:"",disabled:""},xe=["value","data-icon","selected"],De=["id"],ye=["disabled"],ve={value:"",disabled:""},be=["value","data-icon","selected"],we=["id"],Se=["disabled"],_e={value:"",disabled:""},Ce=["value","data-icon","selected"],Me=["id"],Re=["disabled"],Fe={value:"",disabled:""},Ie=["value","data-icon","selected"],je=["id","name"],$e=["name","checked","disabled","value"],Le=["id"],qe=["checked","disabled","value"],Oe={key:12,class:"formField-description mt-1"},Ue={class:"document-generator-menu py-6 flex justify-end flex-grow items-end"},Ne=["disabled"],Ae=(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})],-1),Be=["disabled"],ze=(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6 mr-1"},[(0,a._)("path",{d:"M21.731 2.269a2.625 2.625 0 00-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 000-3.712zM19.513 8.199l-3.712-3.712-8.4 8.4a5.25 5.25 0 00-1.32 2.214l-.8 2.685a.75.75 0 00.933.933l2.685-.8a5.25 5.25 0 002.214-1.32l8.4-8.4z"}),(0,a._)("path",{d:"M5.25 5.25a3 3 0 00-3 3v10.5a3 3 0 003 3h10.5a3 3 0 003-3V13.5a.75.75 0 00-1.5 0v5.25a1.5 1.5 0 01-1.5 1.5H5.25a1.5 1.5 0 01-1.5-1.5V8.25a1.5 1.5 0 011.5-1.5h5.25a.75.75 0 000-1.5H5.25z"})],-1),Ze=["disabled"],Ke=(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})],-1),Pe=["disabled"],He=(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 16.5V9.75m0 0l3 3m-3-3l-3 3M6.75 19.5a4.5 4.5 0 01-1.41-8.775 5.25 5.25 0 0110.233-2.33 3 3 0 013.758 3.848A3.752 3.752 0 0118 19.5H6.75z"})],-1),We={id:"downStatus",class:"modal modal-fixed-footer modalDown"},Je={class:"modal-content flex flex-col"},Te=(0,a.uE)('<div class="modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-[8rem]"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path></svg></div><div class="worn-text text-3xl text-red-700 mb-20 text-center">Внимание!</div><p class="text-2xl mb-6 text-center">Не все запрашиваемые поля заполнены, статус вашего документа будет изменен на &quot;Черновик&quot;.</p>',3),Ve={class:"text-2xl mb-3 text-center"},Ye={class:"modal-footer flex justify-evenly"},Ee=(0,a._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Отмена",-1),Ge={id:"remakeStatus",class:"modal modal-fixed-footer modalRemake"},Qe={class:"modal-content flex flex-col"},Xe=(0,a.uE)('<div class="modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-[8rem]"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path></svg></div><div class="worn-text text-3xl text-red-700 mb-20 text-center">Внимание!</div><p class="text-2xl mb-6 text-center">Не все запрашиваемые поля заполнены, статус документа сотрудника будет изменен на &quot;Переделать&quot;.</p>',3),et={class:"text-2xl mb-3 text-center"},tt={class:"modal-footer flex justify-evenly"},st=(0,a._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Отмена",-1),at={id:"remakeApproval",class:"modal modal-fixed-footer modalRemakeApproval"},it={class:"modal-content flex flex-col"},ot=(0,a._)("div",{class:"modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"},[(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-[8rem]"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})])],-1),nt=(0,a._)("div",{class:"worn-text text-3xl text-red-700 mb-20 text-center"},"Внимание!",-1),lt={class:"text-2xl mb-3 text-center"},dt={class:"modal-footer flex justify-evenly"},rt=(0,a._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Отмена",-1),ct={id:"raject",class:"modal modal-fixed-footer modalRaject"},ut={class:"modal-content flex flex-col"},mt=(0,a._)("div",{class:"modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"},[(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-[8rem]"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})])],-1),ht=(0,a._)("div",{class:"worn-text text-3xl text-red-700 mb-20 text-center"},"Внимание!",-1),pt={class:"text-2xl mb-3 text-center"},gt={class:"modal-footer flex justify-evenly"},ft=(0,a._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Отмена",-1),kt={id:"updateDocumentData",class:"modal modal-fixed-footer modalUpdateDocumentData"},xt={class:"modal-content flex flex-col"},Dt=(0,a._)("div",{class:"modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"},[(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-[8rem]"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})])],-1),yt=(0,a._)("div",{class:"worn-text text-3xl text-red-700 mb-20 text-center"},"Внимание!",-1),vt={class:"text-2xl mb-3 text-center"},bt={class:"modal-footer flex justify-evenly"},wt=(0,a._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Отмена",-1);function St(e,t,s,n,l,d){const r=(0,a.up)("FullScreenLoader"),c=(0,a.up)("Loader");return(0,a.wg)(),(0,a.iD)(a.HY,null,[this.updateProcess?((0,a.wg)(),(0,a.j4)(r,{key:0})):(0,a.kq)("",!0),(0,a._)("div",I,["Готов"===this.documentStatus&&this.$store.state.auth.user.roles.includes("ROLE_MODERATOR")?((0,a.wg)(),(0,a.iD)("button",{key:0,class:"main-btn-yellow px-5 py-3 text-lg flex items-center gap-1",disabled:!this.documentInfo.canChange,onClick:t[0]||(t[0]=(0,o.iM)(((...e)=>d.remakeDocumentModal&&d.remakeDocumentModal(...e)),["prevent"]))},[$,(0,a.Uk)(" Переделать ")],8,j)):(0,a.kq)("",!0)]),(0,a._)("div",L,["Архив"===this.documentStatus||this.documentInfo.canChange||this.loading?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",q," Шаблон документа деактивирован. Редактирование будет возможно, когда шаблон будет вновь активен. ")),(0,a._)("div",O,[(0,a._)("div",U,["Готов"===this.documentStatus?((0,a.wg)(),(0,a.iD)("h4",N,[(0,a.Uk)("Статус: "),(0,a._)("span",A,(0,i.zw)(this.documentStatus),1)])):"Переделать"===this.documentStatus?((0,a.wg)(),(0,a.iD)("h4",B,[(0,a.Uk)("Статус: "),(0,a._)("span",z,(0,i.zw)(this.documentStatus),1)])):"Черновик"===this.documentStatus?((0,a.wg)(),(0,a.iD)("h4",Z,[(0,a.Uk)("Статус: "),(0,a._)("span",K,(0,i.zw)(this.documentStatus),1)])):"Архив"===this.documentStatus?((0,a.wg)(),(0,a.iD)("h4",P,[(0,a.Uk)("Статус: "),(0,a._)("span",H,(0,i.zw)(this.documentStatus),1)])):(0,a.kq)("",!0),(0,a._)("h4",W,[(0,a.Uk)("Тип: "),(0,a._)("span",null,(0,i.zw)(this.documentType),1)]),(0,a._)("h4",J,[(0,a.Uk)("Создал: "),(0,a._)("span",T,(0,i.zw)(this.documentInfo.user?this.documentInfo.user.id===this.$store.state.auth.user.id?"Вы":`${this.documentInfo.user.lastName} ${this.documentInfo.user.name} ${this.documentInfo.user.patronymic}`:"Пользователь"),1)])]),(0,a._)("div",V,[(0,a._)("h4",Y,[(0,a.Uk)("Дата создания: "),(0,a._)("span",null,(0,i.zw)(this.documentInfo.user?this.$normaldate(this.documentInfo.dateCreate):"Пользователь"),1)]),(0,a._)("h4",E,[(0,a.Uk)("Дата обновления: "),(0,a._)("span",null,(0,i.zw)(this.documentInfo.user?this.$normaldate(this.documentInfo.dateUpdate):"Пользователь"),1)])])]),(0,a._)("h2",G,"Наименование: "+(0,i.zw)(this.structureInfo.name),1),(0,a._)("h4",Q,"Описание: "+(0,i.zw)(this.structureInfo.description),1)]),(0,a._)("div",X,[this.loading?((0,a.wg)(),(0,a.j4)(c,{key:0,style:"margin: 0 auto; padding-top: 30px;"})):((0,a.wg)(),(0,a.iD)("form",ee,[(0,a._)("div",te,[se,(0,a._)("div",{class:"chips",onKeyup:[t[1]||(t[1]=(0,o.D2)(((...e)=>d.submitDocumentKeyWords&&d.submitDocumentKeyWords(...e)),["enter"])),t[2]||(t[2]=(0,o.D2)(((...e)=>d.submitDocumentKeyWords&&d.submitDocumentKeyWords(...e)),["delete"]))],onClick:t[3]||(t[3]=(...e)=>d.submitDocumentKeyWords&&d.submitDocumentKeyWords(...e)),onBlur:t[4]||(t[4]=(...e)=>d.submitDocumentKeyWords&&d.submitDocumentKeyWords(...e))},null,32),ae]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.structureData.data,((e,s)=>((0,a.wg)(),(0,a.iD)("div",{class:"formField",key:e.id},[this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:0,class:(0,i.C_)(["formField-name mb-1 ml-5 relative",{required:e.required}])},(0,i.zw)(`Поле №${s+1} — `+(""===e.name?"Заполните поле:":e.name)),3)):(0,a.kq)("",!0),"text"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("input",{key:1,onBlur:t[5]||(t[5]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),disabled:!this.documentInfo.canChange||!this.updateMode,id:e.id,type:"text",name:"",minlength:e.minLength,maxlength:e.maxLength,placeholder:e.placeholder,value:this.intermediateDataCheck[e.id],class:"input-text input-field"},null,40,ie)):"number"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("input",{key:2,onClick:t[6]||(t[6]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),onBlur:t[7]||(t[7]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),disabled:!this.documentInfo.canChange||!this.updateMode,id:e.id,type:"number",name:"",min:e.minValue,max:e.maxValue,step:e.stepValue,value:this.intermediateDataCheck[e.id],placeholder:e.placeholder,class:"input-text input-field"},null,40,oe)):"date"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("input",{key:3,onBlur:t[8]||(t[8]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),min:e.minValue,max:e.maxValue,disabled:!this.documentInfo.canChange||!this.updateMode,id:e.id,type:"date",name:"",value:this.intermediateDataCheck[e.id],placeholder:e.placeholder,class:"input-text input-field"},null,40,ne)):"selectMultiple"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:4,onClick:t[10]||(t[10]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),id:e.id,class:"input-field col s12 selectMultiple"},[(0,a._)("select",{multiple:"",disabled:!this.documentInfo.canChange||!this.updateMode,onClick:t[9]||(t[9]=(...e)=>d.receiveFormData&&d.receiveFormData(...e))},[(0,a._)("option",re,(0,i.zw)(e.placeholder),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.options.data,((t,s)=>((0,a.wg)(),(0,a.iD)("option",{key:t,value:s,selected:void 0!==this.userResponse[e.id]&&!!this.userResponse[e.id].includes(s)},(0,i.zw)(s),9,ce)))),128))],8,de)],8,le)):"selectSingle"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:5,onClick:t[12]||(t[12]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),id:e.id,class:"input-field col s12 selectSingle"},[(0,a._)("select",{disabled:!this.documentInfo.canChange||!this.updateMode,onClick:t[11]||(t[11]=(...e)=>d.receiveFormData&&d.receiveFormData(...e))},[(0,a._)("option",he,(0,i.zw)(e.placeholder),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.options.data,((t,s)=>((0,a.wg)(),(0,a.iD)("option",{key:t,value:s,selected:void 0!==this.userResponse[e.id]&&!!this.userResponse[e.id].includes(s)},(0,i.zw)(s),9,pe)))),128))],8,me)],8,ue)):"selectMultipleImage"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:6,onClick:t[14]||(t[14]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),onBlur:t[15]||(t[15]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),id:e.id,class:"input-field col s12 m6 selectMultipleImage"},[(0,a._)("select",{multiple:"",class:"icons",disabled:!this.documentInfo.canChange||!this.updateMode,onClick:t[13]||(t[13]=(...e)=>d.receiveFormData&&d.receiveFormData(...e))},[(0,a._)("option",ke,(0,i.zw)(e.placeholder),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.employeesList,(t=>((0,a.wg)(),(0,a.iD)("option",{key:t.id,value:t.id,"data-icon":t.imgUrl,selected:void 0!==this.userResponse[e.id]&&d.createUserSelectMult(this.userResponse[e.id],`${t.lastName} ${t.name[0]}. ${t.patronymic[0]}. (№${t.id})`,t.imgUrl)},(0,i.zw)(`${t.lastName} ${t.name[0]}. ${t.patronymic[0]}. (№${t.id})`),9,xe)))),128))],8,fe)],40,ge)):"selectSingleImage"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:7,onClick:t[17]||(t[17]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),id:e.id,class:"input-field col s12 m6 selectSingleImage"},[(0,a._)("select",{class:"icons",disabled:!this.documentInfo.canChange||!this.updateMode,onClick:t[16]||(t[16]=(...e)=>d.receiveFormData&&d.receiveFormData(...e))},[(0,a._)("option",ve,(0,i.zw)(e.placeholder),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.employeesList,(t=>((0,a.wg)(),(0,a.iD)("option",{key:t.id,value:t.id,"data-icon":t.imgUrl,selected:void 0!==this.userResponse[e.id]&&this.userResponse[e.id].imgUrl===t.imgUrl&&this.userResponse[e.id].name===`${t.lastName} ${t.name[0]}. ${t.patronymic[0]}. (№${t.id})`},(0,i.zw)(`${t.lastName} ${t.name[0]}. ${t.patronymic[0]}. (№${t.id})`),9,be)))),128))],8,ye)],8,De)):"selectMultipleStudent"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:8,onClick:t[19]||(t[19]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),onBlur:t[20]||(t[20]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),id:e.id,class:"input-field col s12 m6 selectMultipleStudent"},[(0,a._)("select",{multiple:"",class:"icons",disabled:!this.documentInfo.canChange||!this.updateMode,onClick:t[18]||(t[18]=(...e)=>d.receiveFormData&&d.receiveFormData(...e))},[(0,a._)("option",_e,(0,i.zw)(e.placeholder),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.studentList,(t=>((0,a.wg)(),(0,a.iD)("option",{key:t.id,value:t.id,"data-icon":t.imgUrl,selected:void 0!==this.userResponse[e.id]&&d.createStudentSelectMult(this.userResponse[e.id],`${t.lastName} ${t.name[0]}. ${t.patronymic[0]}. (№${t.id})`)},(0,i.zw)(`${t.lastName} ${t.name[0]}. ${t.patronymic[0]}. (№${t.id})`),9,Ce)))),128))],8,Se)],40,we)):"selectSingleStudent"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:9,onClick:t[22]||(t[22]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),id:e.id,class:"input-field col s12 m6 selectSingleStudent"},[(0,a._)("select",{class:"icons",disabled:!this.documentInfo.canChange||!this.updateMode,onClick:t[21]||(t[21]=(...e)=>d.receiveFormData&&d.receiveFormData(...e))},[(0,a._)("option",Fe,(0,i.zw)(e.placeholder),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.studentList,(t=>((0,a.wg)(),(0,a.iD)("option",{key:t.id,value:t.id,"data-icon":t.imgUrl,selected:void 0!==this.userResponse[e.id]&&this.userResponse[e.id].name===`${t.lastName} ${t.name[0]}. ${t.patronymic[0]}. (№${t.id})`},(0,i.zw)(`${t.lastName} ${t.name[0]}. ${t.patronymic[0]}. (№${t.id})`),9,Ie)))),128))],8,Re)],8,Me)):"radio"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:10,onClick:t[23]||(t[23]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),id:e.id,class:"form-radio inline-block gap-3 input-field",name:e.id},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.options.data,((t,s)=>((0,a.wg)(),(0,a.iD)("label",{key:t,class:"block"},[(0,a._)("input",{type:"radio",name:"group"+e.id,checked:s===this.userResponse[e.id],disabled:!this.documentInfo.canChange||!this.updateMode,id:"",value:s,class:"form-radio-item with-gap block h-5 w-5"},null,8,$e),(0,a._)("span",null,(0,i.zw)(s),1)])))),128))],8,je)):"checkbox"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:11,onClick:t[24]||(t[24]=(...e)=>d.receiveFormData&&d.receiveFormData(...e)),id:e.id,class:"form-checkbox inline-block gap-3 input-field"},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.options.data,((t,s)=>((0,a.wg)(),(0,a.iD)("label",{key:t,class:"block"},[(0,a._)("input",{type:"checkbox",class:"form-checkbox-item filled-in",checked:void 0!==this.userResponse[e.id]&&!!this.userResponse[e.id].includes(s),disabled:!this.documentInfo.canChange||!this.updateMode,value:s},null,8,qe),(0,a._)("span",null,(0,i.zw)(s),1)])))),128))],8,Le)):(0,a.kq)("",!0),e.description&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",Oe,(0,i.zw)(e.description),1)):(0,a.kq)("",!0)])))),128)),(0,a._)("div",Ue,["Черновик"!==this.documentStatus&&this.updateMode?((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:t[25]||(t[25]=(0,o.iM)(((...e)=>d.rajectChangesModal&&d.rajectChangesModal(...e)),["prevent"])),class:"main-btn-red px-5 py-3 text-2xl flex items-center gap-1",type:"submit",disabled:!this.documentInfo.canChange&&!this.updateMode},[Ae,(0,a.Uk)(" Отменить ")],8,Ne)):(0,a.kq)("",!0),this.updateMode||"Архив"===this.documentStatus?this.updateMode?((0,a.wg)(),(0,a.iD)("button",{key:2,class:"main-btn px-5 py-3 text-2xl flex items-center gap-1",onClick:t[27]||(t[27]=(0,o.iM)((e=>{d.saveDocumentData(),d.clickButtonUpdate()}),["prevent"])),disabled:!this.documentInfo.canChange&&!this.updateMode},[Ke,(0,a.Uk)(" Сохранить ")],8,Ze)):(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("button",{key:1,class:"main-btn px-5 py-3 text-2xl flex items-center gap-1",onClick:t[26]||(t[26]=(0,o.iM)(((...e)=>d.changeOperationMode&&d.changeOperationMode(...e)),["prevent"])),disabled:!this.documentInfo.canChange&&!this.updateMode||!this.roles.includes(this.currentUser.roles[0])},[ze,(0,a.Uk)(" Изменить ")],8,Be)),("Черновик"===this.documentStatus||"Переделать"===this.documentStatus&&this.updateMode)&&this.documentFullReady?((0,a.wg)(),(0,a.iD)("button",{key:3,class:"main-btn px-5 py-3 text-2xl flex items-center gap-1",onClick:t[28]||(t[28]=(0,o.iM)(((...e)=>d.publication&&d.publication(...e)),["prevent"])),disabled:!this.documentInfo.canChange&&!this.updateMode},[He,(0,a.Uk)(" Опубликовать ")],8,Pe)):(0,a.kq)("",!0)])])),(0,a._)("div",We,[(0,a._)("div",Je,[Te,(0,a._)("p",Ve,"Вы действительно хотите применить изменения к документу №"+(0,i.zw)(this.documentId)+"?",1)]),(0,a._)("div",Ye,[(0,a._)("button",{class:"main-btn-red inline-block px-5 py-3 w-[150px] text-center text-xl",onClick:t[29]||(t[29]=(...e)=>d.saveChanges&&d.saveChanges(...e))},"Да"),Ee])]),(0,a._)("div",Ge,[(0,a._)("div",Qe,[Xe,(0,a._)("p",et,"Вы действительно хотите применить изменения к документу №"+(0,i.zw)(this.documentId)+"?",1)]),(0,a._)("div",tt,[(0,a._)("button",{class:"main-btn-red inline-block px-5 py-3 w-[150px] text-center text-xl",onClick:t[30]||(t[30]=(...e)=>d.saveChangesRemake&&d.saveChangesRemake(...e))},"Да"),st])]),(0,a._)("div",at,[(0,a._)("div",it,[ot,nt,(0,a._)("p",lt,"Вы действительно хотите изменить статус документа №"+(0,i.zw)(this.documentId)+' на "Переделать"?',1)]),(0,a._)("div",dt,[(0,a._)("button",{class:"main-btn inline-block px-5 py-3 w-[150px] text-center text-xl",onClick:t[31]||(t[31]=(...e)=>d.remakeDocument&&d.remakeDocument(...e))},"Да"),rt])]),(0,a._)("div",ct,[(0,a._)("div",ut,[mt,ht,(0,a._)("p",pt,"Вы действительно хотите отменить изменения документа №"+(0,i.zw)(this.documentId)+"?",1)]),(0,a._)("div",gt,[(0,a._)("button",{class:"main-btn-yellow inline-block px-5 py-3 w-[150px] text-center text-xl",onClick:t[32]||(t[32]=(...e)=>d.rajectChanges&&d.rajectChanges(...e))},"Да"),ft])]),(0,a._)("div",kt,[(0,a._)("div",xt,[Dt,yt,(0,a._)("p",vt,"Вы действительно хотите измененить документ №"+(0,i.zw)(this.documentId)+"?",1)]),(0,a._)("div",bt,[(0,a._)("button",{class:"main-btn inline-block px-5 py-3 w-[150px] text-center text-xl",onClick:t[33]||(t[33]=(...e)=>d.saveDocumentDataRev&&d.saveDocumentDataRev(...e))},"Да"),wt])])])],64)}var _t=s(8573),Ct=s(7882),Mt=s(5753),Rt=s(6775),Ft=s(6270),It=s(6532),jt=s(8806),$t=s(8548),Lt={name:"DocumentGenerator",props:["documentId"],data:()=>({formSelect:null,formChips:null,modalDown:null,modalRemake:null,modalRemakeApproval:null,modalUpdateDocumentData:null,modalRaject:null,chipsData:{},chipsIdMap:{},structureData:{},employeesList:[],message:"",structureInfo:{},updateProcess:!1,updateMode:!1,documentData:"",departmentData:"",documentInfo:{},documentDataDB:"",userKeyWords:[],userResponse:{},documentStatus:"",documentType:"",loading:!0,documentFullReady:!1,appearanceField:{},intermediateData:{userResponse:[]},intermediateDataCheck:{},requiredFieldMap:{},clickSave:!0,clickUpdate:!1,isPublicate:!1,roles:[jt.v.User,jt.v.Moderator],showMess:!0,studentList:[]}),async mounted(){await _t.Z.getKeyWords().then((e=>{for(let t of e.data)this.chipsData[t.name]=null,this.chipsIdMap[t.name]=t.id}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ft.Z[this.message]||"Что-то пошло не так")})),await Ct.Z.getDocument(this.documentId).then((e=>{this.documentInfo=e.data,this.structureInfo.name=e.data.documentStructure.name,this.documentStatus=this.documentInfo.documentStatus.name,this.documentType=this.documentInfo.documentStructure.documentType.name,this.structureInfo.description=e.data.documentStructure.description,this.structureData=e.data.documentStructure.structure;while("string"===typeof this.structureData)this.structureData=JSON.parse(this.structureData);this.documentDataDB=JSON.parse(e.data.documentData);while("string"===typeof this.documentDataDB)this.documentDataDB=JSON.parse(this.documentDataDB);for(let s of this.structureData.data){let e;this.requiredFieldMap[s.id]=s.required;for(let t of this.documentDataDB.userResponse)Object.keys(t)[0]===s.id&&(e=t[s.id]);this.intermediateDataCheck[s.id]=e,void 0!==typeof s.externalDependency&&(this.appearanceField[s.id]=s.externalDependency)}for(let s of this.documentInfo.keyWords)this.userKeyWords.push({tag:s.name});for(let s of this.documentDataDB.userResponse)for(let e in s)this.userResponse[e]=s[e];let t;for(let s of this.documentDataDB.userResponse)if(t=!0,this.requiredFieldMap[Object.keys(s)[0]]&&(""===s[Object.keys(s)[0]]||s[Object.keys(s)[0]]===[]||null===s[Object.keys(s)[0]]||""===s[Object.keys(s)[0]]||"object"===typeof s[Object.keys(s)[0]]&&0===s[Object.keys(s)[0]].length)){t=!1;break}this.documentFullReady=t}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ft.Z[this.message]||"Что-то пошло не так")})),await Mt.Z.getAllUsers().then((e=>{this.employeesList=e.data}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ft.Z[this.message]||"Что-то пошло не так")})),await $t.Z.getAllForDocumentStudent().then((e=>{this.studentList=e.data}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ft.Z[this.message]||"Что-то пошло не так")})),await Mt.Z.getUserDepartment(this.$store.state.auth.user.username).then((e=>{this.departmentData=e.data}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ft.Z[this.message]||"Что-то пошло не так")})),setTimeout((()=>{this.formSelect=M.FormSelect.init(document.querySelectorAll("select"),{}),this.formChips=M.Chips.init(document.querySelectorAll(".chips"),{limit:1/0,data:this.userKeyWords,placeholder:"Введите ключевые слова",secondaryPlaceholder:"+Слово",autocompleteOptions:{data:this.chipsData,limit:1/0,minLength:0}}),this.modalDown=M.Modal.init(document.querySelector(".modalDown"),{}),this.modalRemake=M.Modal.init(document.querySelector(".modalRemake"),{}),this.modalRemakeApproval=M.Modal.init(document.querySelector(".modalRemakeApproval"),{}),this.modalRaject=M.Modal.init(document.querySelector(".modalRaject"),{}),this.modalUpdateDocumentData=M.Modal.init(document.querySelector(".modalUpdateDocumentData"),{})}),0),this.updateMode="Черновик"===this.documentStatus||this.updateMode,this.loading=!1,"documentChange"===this.$route.query.message&&(this.$message(Ft.Z[this.$route.query.message]),this.updateMode=!0)},methods:{async remakeDocument(){this.updateProcess=!0,await this.updateDocumentStatus(It._.Remake),this.updateProcess=!1,this.$emit("updateParent"),this.isPublicate=!0},remakeDocumentModal(){this.modalRemakeApproval.open()},async publication(){this.updateProcess=!0,await this.submitFormData(),await this.updateDocumentStatus(It._.Ready),this.updateProcess=!1,this.$router.push(`/document/${this.documentId}`),this.$emit("updateParent"),this.isPublicate=!0},clickButtonUpdate(){this.clickUpdate=!0},async saveChanges(){this.updateProcess=!0,await this.submitFormData(),await this.updateDocumentStatus(It._.Draft),this.$router.push(`/document/${this.documentId}`),this.updateProcess=!1,this.$emit("updateParent")},async saveChangesRemake(){this.updateProcess=!0,await this.submitFormData(),await this.updateDocumentStatus(It._.Remake),this.$router.push(`/document/${this.documentId}`),this.updateProcess=!1,this.$emit("updateParent")},async changeOperationMode(){this.updateMode=!0,this.$router.push(`/document/${this.documentId}?message=documentChange`),this.$emit("updateParent")},rajectChanges(){this.modalRaject.close(),this.updateMode=!1,this.loading=!0,this.$message("Отмена изменений"),this.$router.push(`/document/${this.documentId}`),setTimeout((()=>{window.location.reload()}),1300)},rajectChangesModal(){this.modalRaject.open()},checkAppearance(e){return void 0===this.appearanceField[e]||void 0!==this.intermediateDataCheck[this.appearanceField[e].id]&&(Array.isArray(this.userResponse[this.appearanceField[e].id])?this.userResponse[this.appearanceField[e].id].includes(this.appearanceField[e].value):this.intermediateDataCheck[this.appearanceField[e].id].toString()===this.appearanceField[e].value.toString())},createUserSelectMult(e,t,s){for(let a of e)if(a.name===t&&a.imgUrl===s)return!0;return!1},createStudentSelectMult(e,t){for(let s of e)if(s.name===t)return!0;return!1},async submitDocumentKeyWords(){setTimeout((()=>{let e=document.querySelectorAll(".chip");if(null!=e){let t=[];for(let s of e)t.push(s.textContent.trim()),void 0===this.chipsData[s.textContent]&&(this.chipsData[s.textContent]=null);_t.Z.attachKeyWord(this.documentId,t)}}),0)},async receiveFormData(){this.intermediateData={userResponse:[]};let e=document.querySelectorAll(".input-field");for(let t of e)if("input"===t.localName){let e={};e[t.id]=t.value.trim(),this.intermediateData.userResponse.push(e),this.intermediateDataCheck[t.id]=t.value.trim()}else if(t.classList.contains("selectMultiple")){let e=[];for(let a of t.querySelectorAll(".selected"))e.push(a.textContent);let s={};s[t.id]=e,this.intermediateData.userResponse.push(s),this.intermediateDataCheck[t.id]=e}else if(t.classList.contains("selectSingle")){let e=t.querySelector(".selected").textContent||"";t.querySelector(".selected").classList.contains("disabled")&&(e="");let s={};s[t.id]=e,this.intermediateData.userResponse.push(s),this.intermediateDataCheck[t.id]=e}else if(t.classList.contains("selectMultipleImage")){let e=[];for(let a of t.querySelectorAll(".selected")){if(a.classList.contains("disabled"))continue;let t={};t["name"]=a.textContent,t["imgUrl"]="img"===a.childNodes[0].localName?a.childNodes[0].attributes["src"].value:"",e.push(t)}let s={};s[t.id]=e,this.intermediateData.userResponse.push(s),this.intermediateDataCheck[t.id]=e}else if(t.classList.contains("selectSingleImage")){let e={},s=t.querySelector(".selected");s.classList.contains("disabled")||(e.name=s.textContent,e.imgUrl="img"===s.childNodes[0].localName?s.childNodes[0].attributes["src"].value:"");let a={};a[t.id]=e,this.intermediateData.userResponse.push(a),this.intermediateDataCheck[t.id]=e}else if(t.classList.contains("selectMultipleStudent")){let e=[];for(let a of t.querySelectorAll(".selected")){if(a.classList.contains("disabled"))continue;let t={};t["name"]=a.textContent,t["imgUrl"]="img"===a.childNodes[0].localName?a.childNodes[0].attributes["src"].value:"",e.push(t)}let s={};s[t.id]=e,this.intermediateData.userResponse.push(s),this.intermediateDataCheck[t.id]=e}else if(t.classList.contains("selectSingleStudent")){let e={},s=t.querySelector(".selected");s.classList.contains("disabled")||(e.name=s.textContent,e.imgUrl="img"===s.childNodes[0].localName?s.childNodes[0].attributes["src"].value:"");let a={};a[t.id]=e,this.intermediateData.userResponse.push(a),this.intermediateDataCheck[t.id]=e}else if(t.classList.contains("form-radio")){let e=t.querySelectorAll(".form-radio-item"),s="";for(let t of e)if(t.checked){s=t.value;break}let a={};a[t.id]=s,this.intermediateData.userResponse.push(a),this.intermediateDataCheck[t.id]=s}else if(t.classList.contains("form-checkbox")){let e=t.querySelectorAll(".form-checkbox-item"),s=[];for(let t of e)t.checked&&s.push(t.value);let a={};a[t.id]=s,this.intermediateData.userResponse.push(a),this.intermediateDataCheck[t.id]=s}else t.classList.contains("chips");"Черновик"===this.documentStatus&&this.submitFormData(),setTimeout((()=>{let e;for(let t of this.intermediateData.userResponse){if(this.requiredFieldMap[Object.keys(t)[0]]&&(""===t[Object.keys(t)[0]]||t[Object.keys(t)[0]]===[]||null===t[Object.keys(t)[0]]||""===t[Object.keys(t)[0]]||"object"===typeof t[Object.keys(t)[0]]&&0===t[Object.keys(t)[0]].length)){e=!1;break}e=!0}this.documentFullReady=e}),300),setTimeout((()=>{this.intermediateData={userResponse:[]};let e,t=document.querySelectorAll(".input-field");for(let s of t)if("input"===s.localName){let e={};e[s.id]=s.value.trim(),this.intermediateData.userResponse.push(e),this.intermediateDataCheck[s.id]=s.value.trim()}else if(s.classList.contains("selectMultiple")){let e=[];for(let a of s.querySelectorAll(".selected"))e.push(a.textContent);let t={};t[s.id]=e,this.intermediateData.userResponse.push(t),this.intermediateDataCheck[s.id]=e}else if(s.classList.contains("selectSingle")){let e=s.querySelector(".selected").textContent||"";s.querySelector(".selected").classList.contains("disabled")&&(e="");let t={};t[s.id]=e,this.intermediateData.userResponse.push(t),this.intermediateDataCheck[s.id]=e}else if(s.classList.contains("selectMultipleImage")){let e=[];for(let a of s.querySelectorAll(".selected")){if(a.classList.contains("disabled"))continue;let t={};t["name"]=a.textContent,t["imgUrl"]="img"===a.childNodes[0].localName?a.childNodes[0].attributes["src"].value:"",e.push(t)}let t={};t[s.id]=e,this.intermediateData.userResponse.push(t),this.intermediateDataCheck[s.id]=e}else if(s.classList.contains("selectSingleImage")){let e={},t=s.querySelector(".selected");t.classList.contains("disabled")||(e.name=t.textContent,e.imgUrl="img"===t.childNodes[0].localName?t.childNodes[0].attributes["src"].value:"");let a={};a[s.id]=e,this.intermediateData.userResponse.push(a),this.intermediateDataCheck[s.id]=e}else if(s.classList.contains("selectMultipleStudent")){let e=[];for(let a of s.querySelectorAll(".selected")){if(a.classList.contains("disabled"))continue;let t={};t["name"]=a.textContent,t["imgUrl"]="img"===a.childNodes[0].localName?a.childNodes[0].attributes["src"].value:"",e.push(t)}let t={};t[s.id]=e,this.intermediateData.userResponse.push(t),this.intermediateDataCheck[s.id]=e}else if(s.classList.contains("selectSingleStudent")){let e={},t=s.querySelector(".selected");t.classList.contains("disabled")||(e.name=t.textContent,e.imgUrl="img"===t.childNodes[0].localName?t.childNodes[0].attributes["src"].value:"");let a={};a[s.id]=e,this.intermediateData.userResponse.push(a),this.intermediateDataCheck[s.id]=e}else if(s.classList.contains("form-radio")){let e=s.querySelectorAll(".form-radio-item"),t="";for(let s of e)if(s.checked){t=s.value;break}let a={};a[s.id]=t,this.intermediateData.userResponse.push(a),this.intermediateDataCheck[s.id]=t}else if(s.classList.contains("form-checkbox")){let e=s.querySelectorAll(".form-checkbox-item"),t=[];for(let s of e)s.checked&&t.push(s.value);let a={};a[s.id]=t,this.intermediateData.userResponse.push(a),this.intermediateDataCheck[s.id]=t}else s.classList.contains("chips");for(let s of this.intermediateData.userResponse){if(this.requiredFieldMap[Object.keys(s)[0]]&&(""===s[Object.keys(s)[0]]||s[Object.keys(s)[0]]===[]||null===s[Object.keys(s)[0]]||""===s[Object.keys(s)[0]]||"object"===typeof s[Object.keys(s)[0]]&&0===s[Object.keys(s)[0]].length)){e=!1;break}e=!0}this.documentFullReady=e}),300)},async submitFormData(){this.updateProcess=!0,("Черновик"!==this.documentStatus||this.clickSave)&&(this.clickSave=!1,this.receiveFormData()),await Ct.Z.updateDocumentData(this.documentId,this.intermediateData).then((e=>{this.documentInfo=e.data,this.structureInfo.name=e.data.documentStructure.name,this.documentStatus=this.documentInfo.documentStatus.name,this.documentType=this.documentInfo.documentStructure.documentType.name,this.structureInfo.description=e.data.documentStructure.description,this.structureData=e.data.documentStructure.structure;while("string"===typeof this.structureData)this.structureData=JSON.parse(this.structureData);this.documentDataDB=JSON.parse(e.data.documentData);while("string"===typeof this.documentDataDB)this.documentDataDB=JSON.parse(this.documentDataDB);for(let s of this.structureData.data){let e;this.requiredFieldMap[s.id]=s.required;for(let t of this.documentDataDB.userResponse)Object.keys(t)[0]===s.id&&(e=t[s.id]);this.intermediateDataCheck[s.id]=e,void 0!==typeof s.externalDependency&&(this.appearanceField[s.id]=s.externalDependency)}for(let s of this.documentInfo.keyWords)this.userKeyWords.push({tag:s.name});for(let s of this.documentDataDB.userResponse)for(let e in s)this.userResponse[e]=s[e];this.documentData=e,this.showMess?(this.$message(`Документ №${this.documentId} обновлен`),this.showMess=!1):this.showMess=!0;let t=!0;for(let s of this.intermediateData.userResponse)if(this.requiredFieldMap[Object.keys(s)[0]]&&(0===s[Object.keys(s)[0]].length||""===s[Object.keys(s)[0]]||s[Object.keys(s)[0]]===[]||null===s[Object.keys(s)[0]]||""===s[Object.keys(s)[0]]||"object"===typeof s[Object.keys(s)[0]]&&0===s[Object.keys(s)[0]].length)){t=!1;break}this.documentFullReady=t,this.clickSave=!0}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ft.Z[this.message]||"Что-то пошло не так")})),await Ct.Z.getDocument(this.documentId).then((e=>{this.documentInfo=e.data,this.structureInfo.name=e.data.documentStructure.name,this.documentStatus=this.documentInfo.documentStatus.name,this.documentType=this.documentInfo.documentStructure.documentType.name,this.structureInfo.description=e.data.documentStructure.description,this.structureData=e.data.documentStructure.structure;while("string"===typeof this.structureData)this.structureData=JSON.parse(this.structureData);this.documentDataDB=JSON.parse(e.data.documentData);while("string"===typeof this.documentDataDB)this.documentDataDB=JSON.parse(this.documentDataDB);for(let s of this.structureData.data){let e;this.requiredFieldMap[s.id]=s.required;for(let t of this.documentDataDB.userResponse)Object.keys(t)[0]===s.id&&(e=t[s.id]);this.intermediateDataCheck[s.id]=e,void 0!==typeof s.externalDependency&&(this.appearanceField[s.id]=s.externalDependency)}for(let s of this.documentInfo.keyWords)this.userKeyWords.push({tag:s.name});for(let s of this.documentDataDB.userResponse)for(let e in s)this.userResponse[e]=s[e];let t;for(let s of this.documentDataDB.userResponse)if(t=!0,this.requiredFieldMap[Object.keys(s)[0]]&&(""===s[Object.keys(s)[0]]||s[Object.keys(s)[0]]===[]||null===s[Object.keys(s)[0]]||""===s[Object.keys(s)[0]]||"object"===typeof s[Object.keys(s)[0]]&&0===s[Object.keys(s)[0]].length)){t=!1;break}this.documentFullReady=t}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ft.Z[this.message]||"Что-то пошло не так")})),this.documentFullReady&&"Готов"===this.documentStatus&&(this.updateMode=!1),this.updateProcess=!1,this.clickUpdate&&(this.$router.replace(this.$route.path),this.clickUpdate=!1,this.$emit("updateParent"))},async updateDocumentStatus(e){this.updateProcess=!0,await Ct.Z.updateDocumentStatus(this.documentId,e).then((t=>{this.documentData=t,this.$message(`Статус документа №${this.documentId} изменен на ${It._[e]}`)}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ft.Z[this.message]||"Что-то пошло не так")})),this.updateProcess=!1},async saveDocumentData(){this.documentStatus!==It._[It._.Ready]||this.documentFullReady||this.documentInfo.user.id!==this.$store.state.auth.user.id?this.documentStatus!==It._[It._.Ready]||this.documentFullReady||this.documentInfo.user.id===this.$store.state.auth.user.id?this.documentStatus!==It._[It._.Draft]?this.modalUpdateDocumentData.open():(await this.submitFormData(),this.$forceUpdate()):this.modalRemake.open():this.modalDown.open()},async saveDocumentDataRev(){await this.submitFormData(),this.$forceUpdate()}},beforeDestroy(){this.formSelect&&this.formSelect.destroy&&this.formSelect.destroy(),this.formChips&&this.formChips.destroy&&this.formChips.destroy(),this.modalDown&&this.modalDown.destroy&&this.modalDown.destroy(),this.modalRemake&&this.modalRemake.destroy&&this.modalRemake.destroy(),this.modalRemakeApproval&&this.modalRemakeApproval.destroy&&this.modalRemakeApproval.destroy(),this.modalRaject&&this.modalRaject.destroy&&this.modalRaject.destroy(),this.modalUpdateDocumentData&&this.modalUpdateDocumentData.destroy&&this.modalUpdateDocumentData.destroy()},computed:{currentUser(){return this.$store.state.auth.user}},components:{CreateMessage:Rt.Z}},qt=s(89);const Ot=(0,qt.Z)(Lt,[["render",St]]);var Ut=Ot,Nt=s(7901),At=s(2461),Bt={name:"DocumentView",props:["documentId"],data:()=>({loading:!0,content:[],modal:null,modified:!1,isDelete:!1,canDelete:!1,komponentKey:0}),async mounted(){await Ct.Z.getDocument(this.documentId).then((e=>{this.canDelete=4!==e.data.documentStatus.id}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(At.Z[this.message]||"Что-то пошло не так"),this.$router.go(-1)})),this.modal=M.Modal.init(document.querySelectorAll(".modal"),{}),this.loading=!1},methods:{onUpdateModified(){this.komponentKey+=1},async deleteDocument(){this.loading=!0,await Ct.Z.deleteDocument(this.documentId).then((e=>{this.isDelete=e}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(At.Z[this.message]||"Что-то пошло не так")})),this.isDelete?this.$router.push("/documents?message=deleteDocument"):this.$error(`Не удалось удалить документ №${this.documentId}`),this.loading=!1},goBack(){this.$router.go(-1)}},beforeDestroy(){this.modal&&this.modal.destroy&&this.modal.destroy()},components:{Sidebar:F.Z,FullScreenLoader:Nt.Z,DocumentGenerator:Ut}};const zt=(0,qt.Z)(Bt,[["render",R]]);var Zt=zt}}]);
//# sourceMappingURL=852.0e78c704.js.map