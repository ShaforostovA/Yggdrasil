"use strict";(self["webpackChunkyggdrasil_client"]=self["webpackChunkyggdrasil_client"]||[]).push([[36],{7882:function(e,t,a){var r=a(4161),s=a(2479);const n="http://10.100.124.9/api/v1/documents/";class u{getDocument(e){return r.Z.get(n+`${e}`,{headers:(0,s.Z)()})}getDocuments(e,t,a,u,o,d,i,m,c){let l=JSON.stringify({typeSearch:e,parameter:t,currentPage:a,sortField:u,sortDir:o,statusName:d,minDate:i,maxDate:m,documentType:c}),h={method:"post",maxBodyLength:1/0,url:n+"all",headers:(0,s.Z)(),data:l};return r.Z.request(h)}getDocumentStructures(){return r.Z.get(n+"structures/short",{headers:(0,s.Z)()})}getDocumentStructure(e){return r.Z.get(n+`structures/${e}`,{headers:(0,s.Z)()})}createDocument(e,t,a,u){let o=JSON.stringify({documentData:JSON.stringify(u),documentStatusId:Number(a),documentStructureId:Number(t),username:e}),d={method:"post",maxBodyLength:1/0,url:n+"create",headers:(0,s.Z)(),data:o};return r.Z.request(d)}deleteDocument(e){return r.Z["delete"](n+"delete/"+e,{headers:(0,s.Z)()})}updateDocumentStatus(e,t){let a=JSON.stringify({documentStatusId:JSON.stringify(t)}),u={method:"post",maxBodyLength:1/0,url:n+`${e}/status/update`,headers:(0,s.Z)(),data:a};return r.Z.request(u)}updateDocumentData(e,t){let a=JSON.stringify({documentData:JSON.stringify(t)}),u={method:"post",maxBodyLength:1/0,url:n+`${e}/data/update`,headers:(0,s.Z)(),data:a};return r.Z.request(u)}getUserStatistics(e,t,a){let u=JSON.stringify({minDate:t,maxDate:a}),o={method:"post",maxBodyLength:1/0,url:n+`statistic/user/${e}`,headers:(0,s.Z)(),data:u};return r.Z.request(o)}getDepartmentStatistics(e,t,a){let u=JSON.stringify({minDate:t,maxDate:a}),o={method:"post",maxBodyLength:1/0,url:n+`statistic/department/${e}`,headers:(0,s.Z)(),data:u};return r.Z.request(o)}getFacultayStatistics(e,t,a){let u=JSON.stringify({minDate:t,maxDate:a}),o={method:"post",maxBodyLength:1/0,url:n+`statistic/faculty/${e}`,headers:(0,s.Z)(),data:u};return r.Z.request(o)}getAllStatistics(e,t){let a=JSON.stringify({minDate:e,maxDate:t}),u={method:"post",maxBodyLength:1/0,url:n+"statistic/all",headers:(0,s.Z)(),data:a};return r.Z.request(u)}getAllDocumentTypes(){return r.Z.get(n+"types/all",{headers:(0,s.Z)()})}checkDocumentTypeName(e){let t=JSON.stringify({name:e}),a={method:"post",maxBodyLength:1/0,url:n+"types/check",headers:(0,s.Z)(),data:t};return r.Z.request(a)}createDocumentType(e){let t=JSON.stringify({name:e}),a={method:"post",maxBodyLength:1/0,url:n+"types/create",headers:(0,s.Z)(),data:t};return r.Z.request(a)}getAdminDocumentStructures(e,t,a,u,o,d,i,m){let c=JSON.stringify({parameter:e,currentPage:t,sortField:a,sortDir:u,isActive:o,minDate:d,maxDate:i,documentTypeName:m}),l={method:"post",maxBodyLength:1/0,url:n+"structures/short/admin",headers:(0,s.Z)(),data:c};return r.Z.request(l)}createDocumentStructure(e,t,a,u,o){let d=JSON.stringify({id:e,name:t,description:a,documentTypeId:u,structureData:JSON.stringify(o)}),i={method:"post",maxBodyLength:1/0,url:n+"structures/create",headers:(0,s.Z)(),data:d};return r.Z.request(i)}updateDocumentStructure(e,t,a,u,o){let d=JSON.stringify({id:e,name:t,description:a,documentTypeId:u,structureData:JSON.stringify(o)}),i={method:"post",maxBodyLength:1/0,url:n+"structures/update",headers:(0,s.Z)(),data:d};return r.Z.request(i)}updateStatusDocumentStructure(e,t){let a=JSON.stringify({id:e,isActive:Boolean(t)}),u={method:"post",maxBodyLength:1/0,url:n+"structures/status/update",headers:(0,s.Z)(),data:a};return r.Z.request(u)}checkDocumentStructure(e){return r.Z.get(n+`structures/${e}/check`,{headers:(0,s.Z)()})}updateStatusDocumentsByStructureId(e){let t=JSON.stringify({id:e}),a={method:"post",maxBodyLength:1/0,url:n+"status/update/remake",headers:(0,s.Z)(),data:t};return r.Z.request(a)}getNewDocumentStructures(e){let t=JSON.stringify({oldDocumentStructureId:e}),a={method:"post",maxBodyLength:1/0,url:n+"structures/new/all",headers:(0,s.Z)(),data:t};return r.Z.request(a)}getAllFacultyDocuments(e,t,a,u){let o=JSON.stringify({documentStructureId:e,facultyId:t,minDate:a,maxDate:u}),d={method:"post",maxBodyLength:1/0,url:n+"faculty/all",headers:(0,s.Z)(),data:o};return r.Z.request(d)}getAllDepartmentDocuments(e,t,a,u){let o=JSON.stringify({documentStructureId:e,departmentId:t,minDate:a,maxDate:u}),d={method:"post",maxBodyLength:1/0,url:n+"department/all",headers:(0,s.Z)(),data:o};return r.Z.request(d)}archivingDocuments(e,t,a,u){let o=JSON.stringify({documentStructureId:e,documentStatusId:t,minDate:a,maxDate:u}),d={method:"post",maxBodyLength:1/0,url:n+"archiving",headers:(0,s.Z)(),data:o};return r.Z.request(d)}documentExportToExcel(e,t,a,u,o){let d=JSON.stringify({documentStructures:e,facultyId:t,departmentId:a,minDate:u,maxDate:o}),i={method:"post",maxBodyLength:1/0,url:n+"export",headers:(0,s.Z)(),responseType:"blob",data:d};return r.Z.request(i)}documentCombinedExportToExcel(e,t,a,u,o){let d=JSON.stringify({documentStructures:e,facultyList:t,departmentList:a,minDate:u,maxDate:o}),i={method:"post",maxBodyLength:1/0,url:n+"combined/export",headers:(0,s.Z)(),responseType:"blob",data:d};return r.Z.request(i)}updateDocumentType(e,t){let a=JSON.stringify({documentTypeName:t}),u={method:"post",maxBodyLength:1/0,url:n+"types/update/"+e,headers:(0,s.Z)(),data:a};return r.Z.request(u)}}t["Z"]=new u},6532:function(e,t,a){a.d(t,{_:function(){return r}});const r={Draft:1,Ready:2,Remake:3,Archive:4,1:"Черновик",2:"Готов",3:"Переделать",4:"Архив","Черновик":1,"Готов":2,"Переделать":3,"Архив":4}},36:function(e,t,a){a.r(t),a.d(t,{default:function(){return O}});var r=a(3396),s=a(9242);const n=(0,r._)("div",{class:"chapter-name text-3xl mb-6"}," Создание документа — Выбор шаблона ",-1),u={class:"flex gap-x-5 flex-grow"},o={class:"menu w-1/5"},d={class:"w-4/5 flex flex-col mb-6"},i={class:"menu-top mb-6"},m=(0,r._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,r._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 15.75L3 12m0 0l3.75-3.75M3 12h18"})],-1),c={key:0,class:"flex gap-6"},l=(0,r._)("div",{class:"left-item flex-grow"},null,-1),h={class:"right-item"},p=["disabled"],g=(0,r._)("div",null,"Продолжить",-1),y=(0,r._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 ml-1 block"},[(0,r._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3"})],-1),D=[g,y];function f(e,t,a,g,y,f){const Z=(0,r.up)("FullScreenLoader"),S=(0,r.up)("Sidebar"),x=(0,r.up)("router-link"),N=(0,r.up)("MainTable");return(0,r.wg)(),(0,r.iD)(r.HY,null,[this.createDocumentProcess?((0,r.wg)(),(0,r.j4)(Z,{key:0})):(0,r.kq)("",!0),n,(0,r._)("div",u,[(0,r._)("div",o,[(0,r.Wm)(S)]),(0,r._)("div",d,[(0,r._)("div",i,[(0,r.Wm)(x,{to:"/documents",class:"main-btn py-3 px-5 inline-flex"},{default:(0,r.w5)((()=>[m,(0,r.Uk)(" Вернуться ")])),_:1})]),(0,r.Wm)(N,{header:this.header,content:this.content,noDataMessage:this.noDataMessage,onUpdateParent:f.onUpdateRadioValue,ref:"mainTable"},null,8,["header","content","noDataMessage","onUpdateParent"]),this.loading?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",c,[l,(0,r._)("div",h,[(0,r._)("button",{class:"main-btn py-3 px-5 inline-flex items-center",disabled:0===this.radioValue,onClick:t[0]||(t[0]=(0,s.iM)(((...e)=>f.createDraftDocument&&f.createDraftDocument(...e)),["prevent"]))},D,8,p)])]))])])],64)}a(7658);var Z=a(2435),S=a(6833),x=a(7882),N=a(6270),b=a(6532),w={name:"DocumentsStructuresView",data:()=>({loading:!0,content:[],header:["","№ шаблона","Наименование структуры","Описание","Дата создания"],noDataMessage:"По вашему запросу структуры документов не найдены",radioValue:0,message:"",createDocumentProcess:!1,documentData:{data:{}}}),async mounted(){await x.Z.getDocumentStructures().then((e=>{for(const t of e.data)this.content.push([{type:"radio",id:t.id},{type:"lable",text:t.id},{type:"lable",text:t.name},{type:"lable",text:t.description},{type:"lable",text:this.$normaldate(t.dateCreate)}])}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(N.Z[this.message]||"Что-то пошло не так")})).finally(this.loading=!1)},methods:{onUpdateRadioValue(e){this.radioValue=e},async createDraftDocument(){let e;this.createDocumentProcess=!0;let t={userResponse:[]};await x.Z.getDocumentStructure(this.radioValue).then((a=>{e=a.data.structure;while("string"===typeof e)e=JSON.parse(e);for(let r of e.data){let e={};e[r.id]=void 0===typeof r.defaultValue||void 0===r.defaultValue?"":r.defaultValue,t.userResponse.push(e)}}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(N.Z[this.message]||"Что-то пошло не так")})),await x.Z.createDocument(this.$store.state.auth.user.username,this.radioValue,b._.Draft,t).then((e=>{this.documentData=e.data}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(N.Z[this.message]||"Что-то пошло не так")})),this.$router.push({name:"document",params:{documentId:this.documentData.id}})},async refresh(){this.loading=!0,this.content=[],this.radioValue=0,this.$refs.mainTable.clearRadioButton(),await x.Z.getDocumentStructures().then((e=>{for(const t of e.data)this.content.push([{type:"radio",id:t.id},{type:"lable",text:t.id},{type:"lable",text:t.name},{type:"lable",text:t.description},{type:"lable",text:this.$normaldate(t.dateCreate)}])}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(N.Z[this.message]||"Что-то пошло не так")})).finally(this.loading=!1)}},components:{Sidebar:Z.Z,MainTable:S.Z}},v=a(89);const J=(0,v.Z)(w,[["render",f]]);var O=J}}]);
//# sourceMappingURL=36.c2d5ce9b.js.map