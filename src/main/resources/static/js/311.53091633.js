"use strict";(self["webpackChunkyggdrasil_client"]=self["webpackChunkyggdrasil_client"]||[]).push([[311],{7882:function(e,t,r){var s=r(4161),a=r(2479);const i="http://10.100.124.9/api/v1/documents/";class u{getDocument(e){return s.Z.get(i+`${e}`,{headers:(0,a.Z)()})}getDocuments(e,t,r,u,o,d,l,n,c){let p=JSON.stringify({typeSearch:e,parameter:t,currentPage:r,sortField:u,sortDir:o,statusName:d,minDate:l,maxDate:n,documentType:c}),h={method:"post",maxBodyLength:1/0,url:i+"all",headers:(0,a.Z)(),data:p};return s.Z.request(h)}getDocumentStructures(){return s.Z.get(i+"structures/short",{headers:(0,a.Z)()})}getDocumentStructure(e){return s.Z.get(i+`structures/${e}`,{headers:(0,a.Z)()})}createDocument(e,t,r,u){let o=JSON.stringify({documentData:JSON.stringify(u),documentStatusId:Number(r),documentStructureId:Number(t),username:e}),d={method:"post",maxBodyLength:1/0,url:i+"create",headers:(0,a.Z)(),data:o};return s.Z.request(d)}deleteDocument(e){return s.Z["delete"](i+"delete/"+e,{headers:(0,a.Z)()})}updateDocumentStatus(e,t){let r=JSON.stringify({documentStatusId:JSON.stringify(t)}),u={method:"post",maxBodyLength:1/0,url:i+`${e}/status/update`,headers:(0,a.Z)(),data:r};return s.Z.request(u)}updateDocumentData(e,t){let r=JSON.stringify({documentData:JSON.stringify(t)}),u={method:"post",maxBodyLength:1/0,url:i+`${e}/data/update`,headers:(0,a.Z)(),data:r};return s.Z.request(u)}getUserStatistics(e,t,r){let u=JSON.stringify({minDate:t,maxDate:r}),o={method:"post",maxBodyLength:1/0,url:i+`statistic/user/${e}`,headers:(0,a.Z)(),data:u};return s.Z.request(o)}getDepartmentStatistics(e,t,r){let u=JSON.stringify({minDate:t,maxDate:r}),o={method:"post",maxBodyLength:1/0,url:i+`statistic/department/${e}`,headers:(0,a.Z)(),data:u};return s.Z.request(o)}getFacultayStatistics(e,t,r){let u=JSON.stringify({minDate:t,maxDate:r}),o={method:"post",maxBodyLength:1/0,url:i+`statistic/faculty/${e}`,headers:(0,a.Z)(),data:u};return s.Z.request(o)}getAllStatistics(e,t){let r=JSON.stringify({minDate:e,maxDate:t}),u={method:"post",maxBodyLength:1/0,url:i+"statistic/all",headers:(0,a.Z)(),data:r};return s.Z.request(u)}getAllDocumentTypes(){return s.Z.get(i+"types/all",{headers:(0,a.Z)()})}checkDocumentTypeName(e){let t=JSON.stringify({name:e}),r={method:"post",maxBodyLength:1/0,url:i+"types/check",headers:(0,a.Z)(),data:t};return s.Z.request(r)}createDocumentType(e){let t=JSON.stringify({name:e}),r={method:"post",maxBodyLength:1/0,url:i+"types/create",headers:(0,a.Z)(),data:t};return s.Z.request(r)}getAdminDocumentStructures(e,t,r,u,o,d,l,n){let c=JSON.stringify({parameter:e,currentPage:t,sortField:r,sortDir:u,isActive:o,minDate:d,maxDate:l,documentTypeName:n}),p={method:"post",maxBodyLength:1/0,url:i+"structures/short/admin",headers:(0,a.Z)(),data:c};return s.Z.request(p)}createDocumentStructure(e,t,r,u,o){let d=JSON.stringify({id:e,name:t,description:r,documentTypeId:u,structureData:JSON.stringify(o)}),l={method:"post",maxBodyLength:1/0,url:i+"structures/create",headers:(0,a.Z)(),data:d};return s.Z.request(l)}updateDocumentStructure(e,t,r,u,o){let d=JSON.stringify({id:e,name:t,description:r,documentTypeId:u,structureData:JSON.stringify(o)}),l={method:"post",maxBodyLength:1/0,url:i+"structures/update",headers:(0,a.Z)(),data:d};return s.Z.request(l)}updateStatusDocumentStructure(e,t){let r=JSON.stringify({id:e,isActive:Boolean(t)}),u={method:"post",maxBodyLength:1/0,url:i+"structures/status/update",headers:(0,a.Z)(),data:r};return s.Z.request(u)}checkDocumentStructure(e){return s.Z.get(i+`structures/${e}/check`,{headers:(0,a.Z)()})}updateStatusDocumentsByStructureId(e){let t=JSON.stringify({id:e}),r={method:"post",maxBodyLength:1/0,url:i+"status/update/remake",headers:(0,a.Z)(),data:t};return s.Z.request(r)}getNewDocumentStructures(e){let t=JSON.stringify({oldDocumentStructureId:e}),r={method:"post",maxBodyLength:1/0,url:i+"structures/new/all",headers:(0,a.Z)(),data:t};return s.Z.request(r)}getAllFacultyDocuments(e,t,r,u){let o=JSON.stringify({documentStructureId:e,facultyId:t,minDate:r,maxDate:u}),d={method:"post",maxBodyLength:1/0,url:i+"faculty/all",headers:(0,a.Z)(),data:o};return s.Z.request(d)}getAllDepartmentDocuments(e,t,r,u){let o=JSON.stringify({documentStructureId:e,departmentId:t,minDate:r,maxDate:u}),d={method:"post",maxBodyLength:1/0,url:i+"department/all",headers:(0,a.Z)(),data:o};return s.Z.request(d)}archivingDocuments(e,t,r,u){let o=JSON.stringify({documentStructureId:e,documentStatusId:t,minDate:r,maxDate:u}),d={method:"post",maxBodyLength:1/0,url:i+"archiving",headers:(0,a.Z)(),data:o};return s.Z.request(d)}documentExportToExcel(e,t,r,u,o){let d=JSON.stringify({documentStructures:e,facultyId:t,departmentId:r,minDate:u,maxDate:o}),l={method:"post",maxBodyLength:1/0,url:i+"export",headers:(0,a.Z)(),responseType:"blob",data:d};return s.Z.request(l)}documentCombinedExportToExcel(e,t,r,u,o){let d=JSON.stringify({documentStructures:e,facultyList:t,departmentList:r,minDate:u,maxDate:o}),l={method:"post",maxBodyLength:1/0,url:i+"combined/export",headers:(0,a.Z)(),responseType:"blob",data:d};return s.Z.request(l)}updateDocumentType(e,t){let r=JSON.stringify({documentTypeName:t}),u={method:"post",maxBodyLength:1/0,url:i+"types/update/"+e,headers:(0,a.Z)(),data:r};return s.Z.request(u)}}t["Z"]=new u},1352:function(e,t,r){var s=r(4161),a=r(2479);const i="http://10.100.124.9/api/v1/reports/";class u{getReport(e){return s.Z.get(i+e,{headers:(0,a.Z)()})}getAllReports(e,t,r,u,o,d,l,n){let c=JSON.stringify({parameter:e,currentPage:t,sortField:r,sortDir:u,statusName:o,minDate:d,maxDate:l,reportType:n}),p={method:"post",maxBodyLength:1/0,url:i+"all",headers:(0,a.Z)(),data:c};return s.Z.request(p)}getAllReportStructures(e,t,r,u,o,d,l,n){let c=JSON.stringify({parameter:e,currentPage:t,sortField:r,sortDir:u,isActive:o,minDate:d,maxDate:l,reportTypeName:n}),p={method:"post",maxBodyLength:1/0,url:i+"structures/all",headers:(0,a.Z)(),data:c};return s.Z.request(p)}getAllActiveReportStructures(){return s.Z.get(i+"structures/active/all",{headers:(0,a.Z)()})}getReportStructureById(e){return s.Z.get(i+"structures/"+e,{headers:(0,a.Z)()})}getAllReportTypes(){return s.Z.get(i+"types/all",{headers:(0,a.Z)()})}checkReportTypeName(e){let t=JSON.stringify({name:e}),r={method:"post",maxBodyLength:1/0,url:i+"types/check",headers:(0,a.Z)(),data:t};return s.Z.request(r)}createReportType(e){let t=JSON.stringify({name:e}),r={method:"post",maxBodyLength:1/0,url:i+"types/create",headers:(0,a.Z)(),data:t};return s.Z.request(r)}checkReportStructure(e){return s.Z.get(i+`structures/${e}/check`,{headers:(0,a.Z)()})}createReportStructure(e,t,r,u,o){let d=JSON.stringify({id:e,name:t,description:r,reportTypeId:u,structureData:JSON.stringify(o)}),l={method:"post",maxBodyLength:1/0,url:i+"structures/create",headers:(0,a.Z)(),data:d};return s.Z.request(l)}updateStatusReportStructure(e,t){let r=JSON.stringify({id:e,isActive:Boolean(t)}),u={method:"post",maxBodyLength:1/0,url:i+"structures/status/update",headers:(0,a.Z)(),data:r};return s.Z.request(u)}updateReportStructure(e,t,r,u,o){let d=JSON.stringify({id:e,name:t,description:r,reportTypeId:u,structureData:JSON.stringify(o)}),l={method:"post",maxBodyLength:1/0,url:i+"structures/update",headers:(0,a.Z)(),data:d};return s.Z.request(l)}getNewReportStructures(e){let t=JSON.stringify({oldReportStructureId:e}),r={method:"post",maxBodyLength:1/0,url:i+"structures/new/all",headers:(0,a.Z)(),data:t};return s.Z.request(r)}createReport(e,t,r,u,o,d){let l=JSON.stringify({reportData:JSON.stringify(e),dateStart:t,dateEnd:r,reportStructureId:u,userId:o,reportStatusId:d}),n={method:"post",maxBodyLength:1/0,url:i+"create",headers:(0,a.Z)(),data:l};return s.Z.request(n)}updateReport(e,t,r,u,o,d,l){let n=JSON.stringify({reportId:e,reportData:JSON.stringify(t),dateStart:r,dateEnd:u,reportStructureId:o,userId:d,reportStatusId:l}),c={method:"post",maxBodyLength:1/0,url:i+"update",headers:(0,a.Z)(),data:n};return s.Z.request(c)}updateReportStatus(e,t){let r=JSON.stringify({reportId:e,statusId:t}),u={method:"post",maxBodyLength:1/0,url:i+"status/update",headers:(0,a.Z)(),data:r};return s.Z.request(u)}updateReportChange(e,t){let r=JSON.stringify({reportId:e,canChange:t}),u={method:"post",maxBodyLength:1/0,url:i+"change/update",headers:(0,a.Z)(),data:r};return s.Z.request(u)}deleteReport(e){return s.Z["delete"](i+"delete/"+e,{headers:(0,a.Z)()})}updateReportType(e,t){let r=JSON.stringify({reportTypeName:t}),u={method:"post",maxBodyLength:1/0,url:i+"types/update/"+e,headers:(0,a.Z)(),data:r};return s.Z.request(u)}}t["Z"]=new u},8310:function(e,t,r){r.d(t,{Z:function(){return $}});var s=r(3396),a=r(7139);const i={class:"input-field col s12 selectSingle w-full"},u=["multiple","disabled"],o=["selected"],d=["value","selected"],l=["multiple","disabled"],n=["selected"],c=["value","selected"],p=["multiple","disabled"],h=["selected"],m=["value","selected"],g=["multiple","disabled"],S=["selected"],y=["value","selected"],v={class:"opacity-0"},w=["multiple","disabled"],x=["selected"],f=["value","selected"],k={class:"opacity-0"};function Z(e,t,r,Z,b,D){return(0,s.wg)(),(0,s.iD)("div",i,["filter"===this.type?((0,s.wg)(),(0,s.iD)("select",{key:0,multiple:this.multy,disabled:this.disabled},[(0,s._)("option",{value:"",selected:this.selected},(0,a.zw)(r.message),9,o),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.content,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e,value:e,selected:e===this.equalId},(0,a.zw)(e),9,d)))),128))],8,u)):Array.isArray(this.equalId)||0===this.content.length||"object"===typeof this.content[0]?Array.isArray(this.equalId)&&0!==this.content.length&&"object"!==typeof this.content[0]?((0,s.wg)(),(0,s.iD)("select",{key:2,multiple:this.multy,disabled:this.disabled},[(0,s._)("option",{value:"",disabled:"",selected:this.selected},(0,a.zw)(r.message),9,h),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.content,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e,value:e,selected:this.isSelect(this.equalId,e)},(0,a.zw)(e),9,m)))),128))],8,p)):Array.isArray(this.equalId)?((0,s.wg)(),(0,s.iD)("select",{key:4,multiple:this.multy,disabled:this.disabled},[(0,s._)("option",{value:"",disabled:"",selected:this.selected},(0,a.zw)(r.message),9,x),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.content,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e.id,value:e.id,selected:this.isSelect(this.equalId,e.id)},[(0,s.Uk)((0,a.zw)(e.name)+" ",1),(0,s._)("span",k,"("+(0,a.zw)(e.id)+")",1)],8,f)))),128))],8,w)):((0,s.wg)(),(0,s.iD)("select",{key:3,multiple:this.multy,disabled:this.disabled},[(0,s._)("option",{value:"",disabled:"",selected:this.selected},(0,a.zw)(r.message),9,S),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.content,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e.id,value:e.id,selected:e.id===this.equalId},[(0,s.Uk)((0,a.zw)(e.name)+" ",1),(0,s._)("span",v,"("+(0,a.zw)(e.id)+")",1)],8,y)))),128))],8,g)):((0,s.wg)(),(0,s.iD)("select",{key:1,multiple:this.multy,disabled:this.disabled},[(0,s._)("option",{value:"",disabled:"",selected:this.selected},(0,a.zw)(r.message),9,n),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.content,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e,value:e,selected:e===this.equalId},(0,a.zw)(e),9,c)))),128))],8,l))])}r(7658);var b={name:"selectComponent",props:["selected","message","content","multy","disabled","equalId","type"],data:()=>({select:null}),mounted(){setTimeout((()=>{this.select=M.FormSelect.init(document.querySelectorAll("select"),{})}),0)},methods:{isSelect(e,t){let r=[];for(let s of e)r.push(Number(s));return r.includes(t)}},computed:{currentUser(){return this.$store.state.auth.user}},beforeDestroy(){this.select&&this.select.destroy&&this.select.destroy()}},D=r(89);const q=(0,D.Z)(b,[["render",Z]]);var $=q},2435:function(e,t,r){r.d(t,{Z:function(){return c}});var s=r(3396),a=r(7139);const i={class:"shadow-md rounded-xl overflow-hidden border"};function u(e,t,r,u,o,d){const l=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("ul",i,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.links,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e.url},[e.roles.includes(this.currentUser.roles[0])?((0,s.wg)(),(0,s.j4)(l,{key:0,"active-class":"active",to:e.url,class:"hover:bg-gray-200 pl-5 py-2 block select-none"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(e.title),1)])),_:2},1032,["to"])):(0,s.kq)("",!0)])))),128))])}var o=r(8806),d={data:()=>({links:[{title:"Документы",url:"/documents",roles:[o.v.User,o.v.Admin,o.v.Moderator]},{title:"Отчеты",url:"/reports",roles:[o.v.Admin,o.v.Moderator]},{title:"Факультеты",url:"/facultets",roles:[o.v.SuperAdmin]},{title:"Кафедры",url:"/departments",roles:[o.v.SuperAdmin]},{title:"Сотрудники",url:"/employees",roles:[o.v.SuperAdmin,o.v.Moderator]},{title:"Студенты",url:"/students",roles:[o.v.User,o.v.SuperAdmin,o.v.Moderator]},{title:"Конструктор шаблонов",url:"/constructors",roles:[o.v.SuperAdmin]},{title:"Статистика",url:"/statistics",roles:[o.v.User,o.v.Admin,o.v.Moderator]},{title:"Разное",url:"/different",roles:[o.v.SuperAdmin]}]}),computed:{currentUser(){return this.$store.state.auth.user}}},l=r(89);const n=(0,l.Z)(d,[["render",u]]);var c=n},8311:function(e,t,r){r.r(t),r.d(t,{default:function(){return Ve}});var s=r(3396),a=r(7139),i=r(9242);const u={key:0,class:"chapter-name text-3xl mb-6"},o={key:1,class:"chapter-name text-3xl mb-6"},d={class:"flex gap-x-5 flex-grow"},l={class:"w-full flex flex-col mb-6"},n={class:"menu-top mb-6 flex justify-between"},c=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,s._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 15.75L3 12m0 0l3.75-3.75M3 12h18"})],-1),p={class:"flex justify-between gap-5"},h=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,s._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 7.5l-2.25-1.313M21 7.5v2.25m0-2.25l-2.25 1.313M3 7.5l2.25-1.313M3 7.5l2.25 1.313M3 7.5v2.25m9 3l2.25-1.313M12 12.75l-2.25-1.313M12 12.75V15m0 6.75l2.25-1.313M12 21.75V19.5m0 2.25l-2.25-1.313m0-16.875L12 2.25l2.25 1.313M21 14.25v2.25l-2.25 1.313m-13.5 0L3 16.5v-2.25"})],-1),m=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,s._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"})],-1),g=["disabled"],S=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,s._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})],-1),y=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6 mr-1"},[(0,s._)("path",{d:"M21.731 2.269a2.625 2.625 0 00-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 000-3.712zM19.513 8.199l-3.712-3.712-8.4 8.4a5.25 5.25 0 00-1.32 2.214l-.8 2.685a.75.75 0 00.933.933l2.685-.8a5.25 5.25 0 002.214-1.32l8.4-8.4z"}),(0,s._)("path",{d:"M5.25 5.25a3 3 0 00-3 3v10.5a3 3 0 003 3h10.5a3 3 0 003-3V13.5a.75.75 0 00-1.5 0v5.25a1.5 1.5 0 01-1.5 1.5H5.25a1.5 1.5 0 01-1.5-1.5V8.25a1.5 1.5 0 011.5-1.5h5.25a.75.75 0 000-1.5H5.25z"})],-1),v=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,s._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})],-1),w=["disabled"],x=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,s._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})],-1),f={id:"myModel",class:"modal modal-fixed-footer",ref:"modal"},k=(0,s.uE)('<div class="modal-content flex flex-col"><div class="modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-[8rem]"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path></svg></div><div class="worn-text text-3xl text-red-700 mb-20 text-center">Внимание!</div><p class="text-2xl mb-3 text-center">При уходе с этой страницы данные будет потеряны.</p></div>',1),Z={class:"modal-footer flex justify-evenly"},b=(0,s._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Остаться",-1),D={id:"updateStatusModel",class:"modal modal-fixed-footer",ref:"updateStatusModel"},q=(0,s.uE)('<div class="modal-content flex flex-col"><div class="modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-[8rem]"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path></svg></div><div class="worn-text text-3xl text-red-700 mb-20 text-center">Внимание!</div><p class="text-2xl mb-10 text-left">При деактивации шаблона, все отчеты на его основе будут заблокированы для редактирования.</p><p class="text-2xl mb-3 text-center">Применить изменения?</p></div>',1),$={class:"modal-footer flex justify-evenly"},N=(0,s._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Нет",-1),_={id:"createTypeModel",class:"modal modal-fixed-footer",ref:"typeCreateModel"},R={class:"modal-content flex flex-col"},C={class:"profile-data-input mb-3"},L=(0,s._)("label",{for:"",class:"relative required"},"Название типа отчета:",-1),I={class:"flex gap-3"},T={class:"w-full"},B={class:"helper-text"},A={key:0,class:"self-center"},J={key:0,class:"",title:"Название свободено."},O=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6 text-green-600"},[(0,s._)("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-2.625 6c-.54 0-.828.419-.936.634a1.96 1.96 0 00-.189.866c0 .298.059.605.189.866.108.215.395.634.936.634.54 0 .828-.419.936-.634.13-.26.189-.568.189-.866 0-.298-.059-.605-.189-.866-.108-.215-.395-.634-.936-.634zm4.314.634c.108-.215.395-.634.936-.634.54 0 .828.419.936.634.13.26.189.568.189.866 0 .298-.059.605-.189.866-.108.215-.395.634-.936.634-.54 0-.828-.419-.936-.634a1.96 1.96 0 01-.189-.866c0-.298.059-.605.189-.866zm2.023 6.828a.75.75 0 10-1.06-1.06 3.75 3.75 0 01-5.304 0 .75.75 0 00-1.06 1.06 5.25 5.25 0 007.424 0z","clip-rule":"evenodd"})],-1),U=[O],z={key:1,class:"",title:"Тип отчета с таким названием уже существует!"},j=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6 text-red-700"},[(0,s._)("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-2.625 6c-.54 0-.828.419-.936.634a1.96 1.96 0 00-.189.866c0 .298.059.605.189.866.108.215.395.634.936.634.54 0 .828-.419.936-.634.13-.26.189-.568.189-.866 0-.298-.059-.605-.189-.866-.108-.215-.395-.634-.936-.634zm4.314.634c.108-.215.395-.634.936-.634.54 0 .828.419.936.634.13.26.189.568.189.866 0 .298-.059.605-.189.866-.108.215-.395.634-.936.634-.54 0-.828-.419-.936-.634a1.96 1.96 0 01-.189-.866c0-.298.059-.605.189-.866zm-4.34 7.964a.75.75 0 01-1.061-1.06 5.236 5.236 0 013.73-1.538 5.236 5.236 0 013.695 1.538.75.75 0 11-1.061 1.06 3.736 3.736 0 00-2.639-1.098 3.736 3.736 0 00-2.664 1.098z","clip-rule":"evenodd"})],-1),V=[j],H={class:"modal-footer flex justify-evenly"},P=(0,s._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Отменить",-1),Y=["disabled"],E={key:1,class:"flex gap-5"},K={class:"structure-vue w-full shadow-md rounded-xl border p-4"},F={key:0,class:""},W={class:"mb-3"},X={class:"active"},G={key:0,class:"text-green-600"},Q={key:1,class:"disables text-yellow-600"},ee={class:"date-block flex justify-end mb-3"},te={class:"date-body"},re={class:"date-create"},se={class:"date-create"},ae={key:0,class:"old-report-structure mb-3"},ie=(0,s._)("div",{class:"old-report-structure-title"},"Шаблон основан на:",-1),ue={key:1,class:"list-new-report-structure mb-3 flex gap-3"},oe=(0,s._)("div",{class:"list-new-report-structure-title w-1/5"},"Шаблоны основанные на этом шаблоне:",-1),de={class:"newReportStructuresList flex flex-wrap gap-2 w-4/5"},le={class:"structure-top-header"},ne={class:"profile-data-input flex-grow mb-3"},ce=(0,s._)("label",{for:"",class:"relative required"},"Название шаблона:",-1),pe=["disabled"],he={class:"helper-text"},me={class:"profile-data-input flex-grow mb-3"},ge=(0,s._)("label",{for:"",class:""},"Описание шаблона:",-1),Se=["disabled"],ye={class:"helper-text"},ve={class:"profile-data-input flex-grow mb-3"},we=(0,s._)("label",{for:"",class:"relative required"},"Тип отчета:",-1),xe={class:"flex gap-3"},fe={class:"input-field col s12 selectSingle w-full report-type-select"},ke=["disabled"],Ze=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,s._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})],-1),be={class:"profile-data-input flex-grow mb-10"},De=(0,s._)("label",{for:"",class:"relative required"},"Перечень документов:",-1),Me={class:"flex gap-3"},qe={class:"input-field col s12 selectSingle w-full document-structures-select"},$e={class:"flex justify-end"},Ne=(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,s._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})],-1);function _e(e,t,r,M,O,j){const _e=(0,s.up)("loader"),Re=(0,s.up)("router-link"),Ce=(0,s.up)("SelectVue");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.createMode?((0,s.wg)(),(0,s.iD)("div",u," Конструктор шаблона — Отчеты ")):((0,s.wg)(),(0,s.iD)("div",o," Просмотр шаблона отчетов — №"+(0,a.zw)(this.$route.query.reportStructure),1)),(0,s._)("div",d,[(0,s._)("div",l,[(0,s._)("div",n,[(0,s._)("button",{class:"main-btn py-3 px-5 inline-flex",onClick:t[0]||(t[0]=(0,i.iM)(((...e)=>j.leavingPage&&j.leavingPage(...e)),["prevent"]))},[c,(0,s.Uk)(" Вернуться ")]),(0,s._)("div",p,[this.createMode||this.updateMode||!this.isActive?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:0,class:"main-btn-yellow px-5 py-3 text-lg flex items-center gap-1",onClick:t[1]||(t[1]=(0,i.iM)(((...e)=>j.updateReportStatus&&j.updateReportStatus(...e)),["prevent"]))},[h,(0,s.Uk)(" Деактивировать ")])),this.createMode||this.updateMode||this.isActive?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:1,class:"main-btn px-5 py-3 text-lg flex items-center gap-1",onClick:t[2]||(t[2]=(0,i.iM)(((...e)=>j.revActivationReportStructure&&j.revActivationReportStructure(...e)),["prevent"]))},[m,(0,s.Uk)(" Активировать ")])),this.createMode?((0,s.wg)(),(0,s.iD)("button",{key:2,class:"main-btn py-3 px-5 inline-flex",onClick:t[3]||(t[3]=(0,i.iM)(((...e)=>j.createNewReportStructure&&j.createNewReportStructure(...e)),["prevent"])),disabled:""===this.nameStructure||0===this.documnetSelectedStructures.length||0===this.typesReports.length},[S,(0,s.Uk)(" Опубликовать ")],8,g)):(0,s.kq)("",!0),this.canWritePoles||this.updateMode?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:3,class:"main-btn py-3 px-5 inline-flex",onClick:t[4]||(t[4]=(0,i.iM)(((...e)=>j.onUpdateMode&&j.onUpdateMode(...e)),["prevent"]))},[y,(0,s.Uk)(" Изменить ")])),this.updateMode?((0,s.wg)(),(0,s.iD)("button",{key:4,class:"main-btn-red py-3 px-5 flex items-center gap-1",onClick:t[5]||(t[5]=(0,i.iM)(((...e)=>j.rajectChangesStructure&&j.rajectChangesStructure(...e)),["prevent"]))},[v,(0,s.Uk)(" Отменить ")])):(0,s.kq)("",!0),this.updateMode?((0,s.wg)(),(0,s.iD)("button",{key:5,class:"main-btn py-3 px-5 flex items-center gap-1",onClick:t[6]||(t[6]=(0,i.iM)(((...e)=>j.updateReportStructure&&j.updateReportStructure(...e)),["prevent"])),disabled:!this.updateMode||""===this.nameStructure||this.documnetSelectedStructures&&0===this.documnetSelectedStructures.length},[x,(0,s.Uk)(" Сохранить ")],8,w)):(0,s.kq)("",!0)]),(0,s._)("div",f,[k,(0,s._)("div",Z,[(0,s._)("button",{onClick:t[7]||(t[7]=(0,i.iM)(((...e)=>j.back&&j.back(...e)),["prevent"])),class:"main-btn inline-block px-5 py-3 w-[150px] text-center text-xl"},"Уйти"),b])],512),(0,s._)("div",D,[q,(0,s._)("div",$,[N,(0,s._)("button",{onClick:t[8]||(t[8]=(0,i.iM)(((...e)=>j.revActivationReportStructure&&j.revActivationReportStructure(...e)),["prevent"])),class:"main-btn inline-block px-5 py-3 w-[150px] text-center text-xl"},"Да")])],512),(0,s._)("div",_,[(0,s._)("div",R,[(0,s._)("div",C,[L,(0,s._)("div",I,[(0,s._)("div",T,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[9]||(t[9]=t=>e.typeName=t),onInput:t[10]||(t[10]=e=>this.checkReportTypeName()),class:(0,a.C_)([{invalid:M.v$.typeName.$errors.length},"input-text"]),minlength:"1",maxlength:"50",required:"",type:"text",name:"",id:"",placeholder:"Название типа отчета",title:"Введите название типа отчета"},null,34),[[i.nr,e.typeName,void 0,{trim:!0}]]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(M.v$.typeName.$errors,(e=>((0,s.wg)(),(0,s.iD)("div",{class:"input-errors max-w-xl",key:e.$uid},[(0,s._)("div",B,(0,a.zw)("This field should be at least 1 characters long"===e.$message?"Длина этого поля должна составлять не менее 1 символа":"Value is required"===e.$message?"Значение является обязательным":e.$message),1)])))),128))]),this.typeName?((0,s.wg)(),(0,s.iD)("div",A,[this.validTypeName?((0,s.wg)(),(0,s.iD)("div",J,U)):((0,s.wg)(),(0,s.iD)("div",z,V))])):(0,s.kq)("",!0)])])]),(0,s._)("div",H,[P,(0,s._)("button",{onClick:t[11]||(t[11]=(0,i.iM)(((...e)=>j.createReportType&&j.createReportType(...e)),["prevent"])),disabled:!this.validTypeName,class:"main-btn inline-block px-5 py-3 w-[150px] text-center text-xl"},"Сохранить",8,Y)])],512)]),e.loading?((0,s.wg)(),(0,s.j4)(_e,{key:0})):((0,s.wg)(),(0,s.iD)("div",E,[(0,s._)("div",K,[!1===this.createMode?((0,s.wg)(),(0,s.iD)("div",F,[(0,s._)("div",W,[(0,s._)("div",X,[(0,s.Uk)("Статус: "),this.isActive?((0,s.wg)(),(0,s.iD)("span",G,"Активный")):((0,s.wg)(),(0,s.iD)("span",Q,"Деактивированный"))])]),(0,s._)("div",ee,[(0,s._)("div",te,[(0,s._)("div",re,"Дата создания: "+(0,a.zw)(this.$normaldate(this.dateCreate)),1),(0,s._)("div",se,"Дата обновления: "+(0,a.zw)(this.$normaldate(this.dateUpdate)),1)])]),null!==this.oldStructureReport?((0,s.wg)(),(0,s.iD)("div",ae,[ie,(0,s.Wm)(Re,{class:"p-1 main-btn inline-block",to:"/constructors/report/create?reportStructure="+this.oldStructureReport.id},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(this.oldStructureReport.name+" №("+this.oldStructureReport.id+")"),1)])),_:1},8,["to"])])):(0,s.kq)("",!0),0!==this.listNewReportStructures.length?((0,s.wg)(),(0,s.iD)("div",ue,[oe,(0,s._)("ul",de,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.listNewReportStructures,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e.id,class:"newReportStructuresList-item"},[(0,s.Wm)(Re,{class:"p-1 main-btn block",to:"/constructors/report/create?reportStructure="+e.id},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(e.name+" №("+e.id+")"),1)])),_:2},1032,["to"])])))),128))])])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),(0,s._)("div",le,[(0,s._)("div",ne,[ce,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[12]||(t[12]=t=>e.nameStructure=t),class:(0,a.C_)([{invalid:M.v$.nameStructure.$errors.length},"input-text"]),minlength:"1",maxlength:"255",required:"",type:"text",name:"nameStructure",id:"",placeholder:"Название шаблона",title:"Введите название шаблона",disabled:!this.canWritePoles},null,10,pe),[[i.nr,e.nameStructure,void 0,{trim:!0}]]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(M.v$.nameStructure.$errors,(e=>((0,s.wg)(),(0,s.iD)("div",{class:"input-errors max-w-xl",key:e.$uid},[(0,s._)("div",he,(0,a.zw)("This field should be at least 1 characters long"===e.$message?"Длина этого поля должна составлять не менее 1 символа":"Value is required"===e.$message?"Значение является обязательным":e.$message),1)])))),128))]),(0,s._)("div",me,[ge,(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":t[13]||(t[13]=t=>e.descriptionStructure=t),class:(0,a.C_)([{invalid:M.v$.descriptionStructure.$errors.length},"input-text"]),name:"descriptionStructure",id:"",maxlength:"500",placeholder:"Описание шаблона",disabled:!this.canWritePoles},null,10,Se),[[i.nr,e.descriptionStructure,void 0,{trim:!0}]]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(M.v$.descriptionStructure.$errors,(e=>((0,s.wg)(),(0,s.iD)("div",{class:"input-errors max-w-xl",key:e.$uid},[(0,s._)("div",ye,(0,a.zw)("Value is required"===e.$message?"Значение является обязательным":e.$message),1)])))),128))]),(0,s._)("div",ve,[we,(0,s._)("div",xe,[(0,s._)("div",fe,[((0,s.wg)(),(0,s.j4)(Ce,{selected:!1,content:this.typesReports,message:"Выберите тип отчета",multy:!1,disabled:!this.canWritePoles,equalId:this.selectTypeInLoadStucture,key:this.keySelectReportTypes},null,8,["content","disabled","equalId"]))]),(0,s._)("button",{class:"main-btn py-3 px-5 flex self-start",onClick:t[14]||(t[14]=(0,i.iM)(((...e)=>j.createType&&j.createType(...e)),["prevent"])),disabled:!this.canWritePoles},[Ze,(0,s.Uk)(" Добавить ")],8,ke)])]),(0,s._)("div",be,[De,(0,s._)("div",Me,[(0,s._)("div",qe,[((0,s.wg)(),(0,s.j4)(Ce,{selected:!1,content:this.documentStructures,message:"Выберите документ(ы)",multy:!0,disabled:!this.canWritePoles,equalId:this.documnetSelectedStructures,key:this.keySelectDocumentStructures},null,8,["content","message","disabled","equalId"]))])])]),(0,s._)("div",$e,[this.createMode||this.updateMode?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"main-btn py-3 px-5 flex items-center gap-1",onClick:t[15]||(t[15]=(0,i.iM)(((...e)=>j.updateSelectDocumentStructures&&j.updateSelectDocumentStructures(...e)),["prevent"]))},[Ne,(0,s.Uk)(" Сохранить выбранный перечень ")])):(0,s.kq)("",!0)])])])]))])])],64)}r(7658);var Re=r(2435),Ce=r(6270),Le=r(8310),Ie=r(7901),Te=r(7882),Be=r(1352),Ae=r(3053),Je=r(9117),Oe=r(2281),Ue={name:"ConstructorReportView",setup(){return{v$:(0,Ae.Xw)()}},data:()=>({modal:null,typeModel:null,updateStatusModel:null,loading:!0,updateMode:!1,createMode:!1,typeName:"",typesReports:[],validTypeName:!1,selectTypeInLoadStucture:-1,keySelectReportTypes:1,keySelectDocumentStructures:1,nameStructure:"",descriptionStructure:"",dateCreate:"",dateUpdate:"",documnetSelectedStructures:[],isActive:!0,documentStructures:[],selectDoucumentStructures:null,listNewReportStructures:[],oldStructureReport:null}),validations(){return{typeName:{required:Je.C1,minLength:(0,Je.Ei)(1),maxLength:(0,Je.BS)(50)},nameStructure:{required:Je.C1,minLength:(0,Je.Ei)(1),maxLength:(0,Je.BS)(255)},descriptionStructure:{maxLength:(0,Je.BS)(500)}}},async mounted(){Ce.Z[this.$route.query.message]&&this.$message(Ce.Z[this.$route.query.message]),void 0===this.$route.query.reportStructure?(this.createMode=!0,setTimeout((()=>{this.updateComp()}))):(await Be.Z.checkReportStructure(this.$route.query.reportStructure).then((e=>{e.data||this.$router.go(-1)}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})),await Be.Z.getReportStructureById(this.$route.query.reportStructure).then((e=>{this.nameStructure=e.data.name,this.descriptionStructure=e.data.description,this.selectTypeInLoadStucture=e.data.reportType.id,this.dateCreate=e.data.dateCreate,this.dateUpdate=e.data.dateUpdate,this.documnetSelectedStructures=JSON.parse(e.data.reportStructure),this.isActive=e.data.isActive;while("string"===typeof this.documnetSelectedStructures)this.documnetSelectedStructures=JSON.parse(this.documnetSelectedStructures);this.documnetSelectedStructures=this.documnetSelectedStructures.data,null!==e.data.oldStructureId&&""!==e.data.oldStructureId?Be.Z.getReportStructureById(e.data.oldStructureId).then((e=>{this.oldStructureReport=e.data,this.updateComp()}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})):this.oldStructureReport=null,this.updateComp()}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})),this.updateComp()),await Be.Z.getAllReportTypes().then((e=>{this.typesReports=e.data,setTimeout((()=>{this.updateComp()}))}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})),await Te.Z.getDocumentStructures().then((e=>{this.documentStructures=e.data,this.updateComp()}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})),await Be.Z.getNewReportStructures(this.$route.query.reportStructure).then((e=>{this.listNewReportStructures=e.data,this.updateComp()}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})),setTimeout((()=>{this.modal=M.Modal.init(this.$refs.modal),this.typeModel=M.Modal.init(this.$refs.typeCreateModel),this.updateStatusModel=M.Modal.init(this.$refs.updateStatusModel),this.selectDoucumentStructures=M.FormSelect.init(document.querySelector(".document-structures-select select")),this.updateComp()}),0),this.loading=!1},methods:{async checkReportTypeName(){await Be.Z.checkReportTypeName(this.typeName).then((e=>{e.data||""===this.typeName?this.validTypeName=!1:this.validTypeName=!0}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")}))},createType(){this.typeModel.open()},async createReportType(){this.loading=!0,await Be.Z.createReportType(this.typeName).then((e=>{this.typeName="",Be.Z.getAllReportTypes().then((e=>{this.typesReports=e.data,this.keySelectReportTypes+=1}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})),this.typeModel.close(),this.$message(`Тип отчета №${e.data.id} создан`)}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})),this.loading=!1},updateSelectDocumentStructures(){this.documnetSelectedStructures=[];let e=document.querySelectorAll('.document-structures-select li[class="selected"]');for(let t of e){let e=t.innerText.split(" ");this.documnetSelectedStructures.push(e[e.length-1].replace(/^.|.$/g,""))}},async createNewReportStructure(){this.loading=!0;let e=document.querySelector(".report-type-select").querySelectorAll("li"),t="",r={data:[]};r.data=this.documnetSelectedStructures;for(let s of e)if(s.classList.value.includes("selected")){let e=s.textContent.split(" ");t=e[e.length-1].replace(/^.|.$/g,"");break}await Be.Z.createReportStructure("",this.nameStructure,this.descriptionStructure,t,r).then((e=>{this.$message(`Создан Шаблон отчетов №${e.data.id}`),this.nameStructure="",this.descriptionStructure="",this.documnetSelectedStructures=[],this.updateComp()})),this.loading=!1},updateReportStatus(){this.updateStatusModel.open()},revActivationReportStructure(){this.loading=!0,this.updateStatusModel.close(),Be.Z.updateStatusReportStructure(this.$route.query.reportStructure,!this.isActive).then((e=>{this.isActive?this.$message(`Шаблон №${this.$route.query.reportStructure} деактивирован`):this.$message(`Шаблон №${this.$route.query.reportStructure} активирован`),this.isActive=!this.isActive})),this.loading=!1},async rajectChangesStructure(){this.loading=!0,await Be.Z.getReportStructureById(this.$route.query.reportStructure).then((e=>{this.nameStructure=e.data.name,this.descriptionStructure=e.data.description,this.selectTypeInLoadStucture=e.data.reportType.id,this.dateCreate=e.data.dateCreate,this.dateUpdate=e.data.dateUpdate,this.documnetSelectedStructures=JSON.parse(e.data.reportStructure);while("string"===typeof this.documnetSelectedStructures)this.documnetSelectedStructures=JSON.parse(this.documnetSelectedStructures);this.documnetSelectedStructures=this.documnetSelectedStructures.data,null!==e.data.oldStructureId&&""!==e.data.oldStructureId?Be.Z.getReportStructureById(e.data.oldStructureId).then((e=>{this.oldStructureReport=e.data,this.updateComp()}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})):this.oldStructureReport=null,this.updateComp()}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})),this.updateMode=!1,this.loading=!1,this.updateComp(),this.$message("Изменения отменены")},async updateReportStructure(){this.loading=!0;let e=document.querySelector(".report-type-select").querySelectorAll("li"),t="",r={data:[]};if(void 0!==this.documnetSelectedStructures&&0!==this.documnetSelectedStructures.length){r.data=this.documnetSelectedStructures;for(let r of e)if(r.classList.value.includes("selected")){let e=r.textContent.split(" ");t=e[e.length-1].replace(/^.|.$/g,"");break}await Be.Z.updateReportStructure(this.$route.query.reportStructure,this.nameStructure,this.descriptionStructure,t,r).then((e=>{this.$message(`Обновлен Шаблон отчетов №${e.data.id}`),this.nameStructure=e.data.name,this.descriptionStructure=e.data.description,this.selectTypeInLoadStucture=e.data.reportType.id,this.dateCreate=e.data.dateCreate,this.dateUpdate=e.data.dateUpdate,this.documnetSelectedStructures=JSON.parse(e.data.reportStructure);while("string"===typeof this.documnetSelectedStructures)this.documnetSelectedStructures=JSON.parse(this.documnetSelectedStructures);this.documnetSelectedStructures=this.documnetSelectedStructures.data,this.updateMode=!1,this.updateComp()})),this.loading=!1}else this.$error("Необходимо выбрать хотя бы 1 документ")},leavingPage(){this.updateMode||this.createMode?this.modal.open():this.back()},back(){this.$router.push("/constructors")},onUpdateMode(){this.updateMode=!0,this.updateComp()},updateComp(){this.keySelectReportTypes+=1,this.keySelectDocumentStructures+=1}},beforeDestroy(){this.modal&&this.modal.destroy&&this.modal.destroy(),this.typeModel&&this.typeModel.destroy&&this.typeModel.destroy(),this.updateStatusModel&&this.updateStatusModel.destroy&&this.updateStatusModel.destroy(),this.selectDoucumentStructures&&this.selectDoucumentStructures.destroy&&this.selectDoucumentStructures.destroy()},computed:{canWritePoles(){return this.updateMode||this.createMode}},watch:{async $route(){this.listNewReportStructures=[],this.loading=!0,Ce.Z[this.$route.query.message]&&this.$message(Ce.Z[this.$route.query.message]),void 0===this.$route.query.reportStructure?(this.createMode=!0,setTimeout((()=>{this.updateComp()}))):(await Be.Z.checkReportStructure(this.$route.query.reportStructure).then((e=>{e.data||this.$router.go(-1)}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})),await Be.Z.getReportStructureById(this.$route.query.reportStructure).then((e=>{this.nameStructure=e.data.name,this.descriptionStructure=e.data.description,this.selectTypeInLoadStucture=e.data.reportType.id,this.dateCreate=e.data.dateCreate,this.dateUpdate=e.data.dateUpdate,this.isActive=e.data.isActive,this.documnetSelectedStructures=JSON.parse(e.data.reportStructure);while("string"===typeof this.documnetSelectedStructures)this.documnetSelectedStructures=JSON.parse(this.documnetSelectedStructures);this.documnetSelectedStructures=this.documnetSelectedStructures.data,null!==e.data.oldStructureId&&""!==e.data.oldStructureId?Be.Z.getReportStructureById(e.data.oldStructureId).then((e=>{this.oldStructureReport=e.data,this.updateComp()}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})):this.oldStructureReport=null,this.updateComp()}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})),await Be.Z.getNewReportStructures(this.$route.query.reportStructure).then((e=>{this.listNewReportStructures=e.data,this.updateComp()}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})),this.updateComp()),await Be.Z.getAllReportTypes().then((e=>{this.typesReports=e.data,setTimeout((()=>{this.updateComp()}))}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})),await Te.Z.getDocumentStructures().then((e=>{this.documentStructures=e.data,this.updateComp()}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(Ce.Z[this.message]||"Что-то пошло не так")})),this.loading=!1}},components:{Sidebar:Re.Z,FullScreenLoader:Ie.Z,SelectVue:Le.Z,Loader:Oe.Z}},ze=r(89);const je=(0,ze.Z)(Ue,[["render",_e]]);var Ve=je}}]);
//# sourceMappingURL=311.53091633.js.map