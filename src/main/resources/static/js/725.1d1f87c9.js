"use strict";(self["webpackChunkyggdrasil_client"]=self["webpackChunkyggdrasil_client"]||[]).push([[725],{6725:function(e,t,i){i.r(t),i.d(t,{default:function(){return ne}});var a=i(3396),s=i(7139);const r={class:"chapter-name text-3xl mb-6"},l={class:"flex gap-x-5 flex-grow"},o={class:"menu w-1/5"},n={class:"w-4/5 flex flex-col mb-6"},d={class:"menu-top mb-6"},c=(0,a._)("button",{class:"modal-trigger main-btn py-3 px-5 inline-flex","data-target":"myModel"},[(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 mr-1"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 15.75L3 12m0 0l3.75-3.75M3 12h18"})]),(0,a.Uk)(" Вернуться ")],-1),u={id:"myModel",class:"modal modal-fixed-footer",ref:"modal"},m=(0,a.uE)('<div class="modal-content flex flex-col"><div class="modal-img inline-block p-10 rounded-full border-[8px] border-solid border-red-700 text-red-700 mx-auto mb-5 font-bold"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-[8rem]"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path></svg></div><div class="worn-text text-3xl text-red-700 mb-20 text-center">Внимание!</div><p class="text-2xl mb-3 text-center">При уходе с этой страницы данные будет потеряны!</p></div>',1),p={class:"modal-footer flex justify-evenly"},h=(0,a._)("a",{href:"#",class:"modal-close main-btn-invers inline-block rounded-lg px-5 py-3 w-[150px] text-center text-xl"},"Остаться",-1);function g(e,t,i,g,v,f){const D=(0,a.up)("Sidebar"),k=(0,a.up)("router-link"),y=(0,a.up)("FormGenerator");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",r," Создание документа — Шаблон №"+(0,s.zw)(this.structureId),1),(0,a._)("div",l,[(0,a._)("div",o,[(0,a.Wm)(D)]),(0,a._)("div",n,[(0,a._)("div",d,[c,(0,a._)("div",u,[m,(0,a._)("div",p,[(0,a.Wm)(k,{to:{name:"documentStructure"},class:"main-btn inline-block px-5 py-3 w-[150px] text-center text-xl"},{default:(0,a.w5)((()=>[(0,a.Uk)("Уйти")])),_:1}),h])],512)]),(0,a.Wm)(y,{structureId:this.structureId},null,8,["structureId"])])])],64)}var v=i(2435),f=i(9242);const D={class:"structure-info mb-5"},k={class:"structure-name text-2xl mb-3"},y={class:"structure-description text-xl"},w={class:"formGenerated flex-grow flex"},x=(0,a._)("div",{class:"formField"},[(0,a._)("div",{class:"formField-name mb-1 ml-5 relative"},"Ключевые слова:"),(0,a._)("div",{class:"chips"}),(0,a._)("div",{class:"formField-description mt-1"},"Укажите ключевые слова (для добавления слов необходимо выбрать их из выпадающего списка или ввести с клавиатуры и нажать enter).")],-1),b=["id","required","minlength","maxlength","placeholder","value"],F=["id","required","min","max","step","value","placeholder"],S=["id","required","placeholder","value"],_=["id"],C={multiple:""},q={value:"",disabled:"",selected:""},I=["value"],L=["id"],A={value:"",disabled:"",selected:""},z=["value"],$=["id"],Z={multiple:"",class:"icons"},B={value:"",disabled:"",selected:""},N=["value","data-icon"],H=["id"],R={class:"icons"},U={value:"",disabled:"",selected:""},Y=["value","data-icon"],j=["id","name"],K=["name","value"],V=["id"],W=["value"],G={key:10,class:"formField-description mt-1"},P=(0,a._)("div",{class:"createForm-menu py-6 flex justify-end"},[(0,a._)("button",{class:"main-btn px-5 py-3 text-2xl flex items-center gap-1",type:"submit"},[(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})]),(0,a.Uk)(" Создать ")])],-1);function O(e,t,i,r,l,o){const n=(0,a.up)("FullScreenLoader"),d=(0,a.up)("CreateMessage"),c=(0,a.up)("Loader");return(0,a.wg)(),(0,a.iD)(a.HY,null,[this.createProcess?((0,a.wg)(),(0,a.j4)(n,{key:0})):(0,a.kq)("",!0),""!==this.documentData?((0,a.wg)(),(0,a.j4)(d,{key:1,structureId:this.structureId,structureName:this.structureInfo.name,documentId:this.documentData.data.id,typeCreate:"Документ"},null,8,["structureId","structureName","documentId"])):(0,a.kq)("",!0),(0,a._)("div",D,[(0,a._)("h2",k,"Наименование: "+(0,s.zw)(this.structureInfo.name),1),(0,a._)("h4",y,"Описание: "+(0,s.zw)(this.structureInfo.description),1)]),(0,a._)("div",w,[this.loading?((0,a.wg)(),(0,a.j4)(c,{key:0,class:"mx-auto my-36"})):((0,a.wg)(),(0,a.iD)("form",{key:1,action:"",class:"createForm flex-grow border rounded-xl shadow-md overflow-hidden py-3 px-5 mb-6 flex-col",onSubmit:t[10]||(t[10]=(0,f.iM)(((...e)=>o.submitFormData&&o.submitFormData(...e)),["prevent"]))},[x,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.structureData.data,((e,i)=>((0,a.wg)(),(0,a.iD)("div",{class:"formField",key:e.id},[this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:0,class:(0,s.C_)(["formField-name mb-1 ml-5 relative",{required:e.required}])},(0,s.zw)(`Поле №${i+1} — `+(""===e.name?"Заполните поле:":e.name)),3)):(0,a.kq)("",!0),"text"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("input",{key:1,onBlur:t[0]||(t[0]=(...e)=>o.receiveFormData&&o.receiveFormData(...e)),id:e.id,required:e.required,type:"text",name:"",minlength:e.minLength,maxlength:e.maxLength,placeholder:e.placeholder,value:this.intermediateDataCheck[e.id],class:"input-text input-field"},null,40,b)):"number"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("input",{key:2,onClick:t[1]||(t[1]=(...e)=>o.receiveFormData&&o.receiveFormData(...e)),onBlur:t[2]||(t[2]=(...e)=>o.receiveFormData&&o.receiveFormData(...e)),id:e.id,required:e.required,type:"number",name:"",min:e.minValue,max:e.maxValue,step:e.stepValue,value:this.intermediateDataCheck[e.id],placeholder:e.placeholder,class:"input-text input-field"},null,40,F)):"date"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("input",{key:3,onBlur:t[3]||(t[3]=(...e)=>o.receiveFormData&&o.receiveFormData(...e)),id:e.id,required:e.required,type:"date",name:"",placeholder:e.placeholder,value:this.intermediateDataCheck[e.id],class:"input-text input-field"},null,40,S)):"selectMultiple"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:4,onBlur:t[4]||(t[4]=(...e)=>o.receiveFormData&&o.receiveFormData(...e)),id:e.id,class:"input-field col s12 selectMultiple"},[(0,a._)("select",C,[(0,a._)("option",q,(0,s.zw)(e.placeholder),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.options.data,((e,t)=>((0,a.wg)(),(0,a.iD)("option",{key:e,value:t},(0,s.zw)(t),9,I)))),128))])],40,_)):"selectSingle"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:5,onBlur:t[5]||(t[5]=(...e)=>o.receiveFormData&&o.receiveFormData(...e)),id:e.id,class:"input-field col s12 selectSingle"},[(0,a._)("select",null,[(0,a._)("option",A,(0,s.zw)(e.placeholder),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.options.data,((e,t)=>((0,a.wg)(),(0,a.iD)("option",{key:e,value:t},(0,s.zw)(t),9,z)))),128))])],40,L)):"selectMultipleImage"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:6,onBlur:t[6]||(t[6]=(...e)=>o.receiveFormData&&o.receiveFormData(...e)),id:e.id,class:"input-field col s12 m6 selectMultipleImage"},[(0,a._)("select",Z,[(0,a._)("option",B,(0,s.zw)(e.placeholder),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.employeesList,(e=>((0,a.wg)(),(0,a.iD)("option",{key:e.id,value:e.id,"data-icon":e.imgUrl},(0,s.zw)(`${e.lastName} ${e.name[0]}. ${e.patronymic[0]}. (№${e.id})`),9,N)))),128))])],40,$)):"selectSingleImage"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:7,onBlur:t[7]||(t[7]=(...e)=>o.receiveFormData&&o.receiveFormData(...e)),id:e.id,class:"input-field col s12 m6 selectSingleImage"},[(0,a._)("select",R,[(0,a._)("option",U,(0,s.zw)(e.placeholder),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.employeesList,(e=>((0,a.wg)(),(0,a.iD)("option",{key:e.id,value:e.id,"data-icon":e.imgUrl},(0,s.zw)(`${e.lastName} ${e.name[0]}. ${e.patronymic[0]}. (№${e.id})`),9,Y)))),128))])],40,H)):"radio"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:8,onBlur:t[8]||(t[8]=(...e)=>o.receiveFormData&&o.receiveFormData(...e)),id:e.id,class:"form-radio block gap-3 input-field",name:e.id},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.options.data,((t,i)=>((0,a.wg)(),(0,a.iD)("label",{key:t,class:"block"},[(0,a._)("input",{type:"radio",name:"group"+e.id,id:"",value:i,class:"form-radio-item with-gap block h-5 w-5"},null,8,K),(0,a._)("span",null,(0,s.zw)(i),1)])))),128))],40,j)):"checkbox"===e.type&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",{key:9,onBlur:t[9]||(t[9]=(...e)=>o.receiveFormData&&o.receiveFormData(...e)),id:e.id,class:"form-checkbox block gap-3 input-field"},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.options.data,((e,t)=>((0,a.wg)(),(0,a.iD)("label",{key:e,class:"block"},[(0,a._)("input",{type:"checkbox",class:"form-checkbox-item filled-in",value:t},null,8,W),(0,a._)("span",null,(0,s.zw)(t),1)])))),128))],40,V)):(0,a.kq)("",!0),e.description&&this.checkAppearance(e.id)?((0,a.wg)(),(0,a.iD)("div",G,(0,s.zw)(e.description),1)):(0,a.kq)("",!0)])))),128)),P],32))])],64)}i(7658);var T=i(8573),E=i(7882),J=i(5753),Q=i(6775),X=i(6270),ee=i(6532),te={name:"FormGenerator",props:["structureId"],data:()=>({formSelect:null,chipsData:{},chipsIdMap:{},structureData:{},employeesList:[],message:"",structureInfo:{},createProcess:!1,documentData:"",departmentData:"",loading:!0,appearanceField:{},intermediateData:{userResponse:[]},intermediateDataCheck:{},keyWordList:[]}),async mounted(){await T.Z.getKeyWords().then((e=>{for(let t of e.data)this.chipsData[t.name]=null,this.chipsIdMap[t.name]=t.id}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(X.Z[this.message]||"Что-то пошло не так")})),await E.Z.getDocumentStructure(this.structureId).then((e=>{this.structureInfo.name=e.data.name,this.structureInfo.description=e.data.description,this.structureData=JSON.parse(e.data.structure);for(let t of this.structureData.data)this.intermediateDataCheck[t.id]=void 0===typeof t.defaultValue||void 0===t.defaultValue?"":t.defaultValue,void 0!==typeof t.externalDependency&&(this.appearanceField[t.id]=t.externalDependency)}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(X.Z[this.message]||"Что-то пошло не так")})),await J.Z.getUserDepartment().then((e=>{this.departmentData=e.data}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(X.Z[this.message]||"Что-то пошло не так")})),await J.Z.getAllUsers().then((e=>{this.employeesList=e.data}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(X.Z[this.message]||"Что-то пошло не так")})),setTimeout((()=>{this.formSelect=M.FormSelect.init(document.querySelectorAll("select"),{}),this.formChips=M.Chips.init(document.querySelectorAll(".chips"),{limit:1/0,data:[],placeholder:"Введите ключевые слова",secondaryPlaceholder:"+Слово",autocompleteOptions:{data:this.chipsData,limit:1/0,minLength:0}})}),0),this.loading=!1},methods:{checkAppearance(e){return void 0===this.appearanceField[e]||(Array.isArray(this.intermediateDataCheck[this.appearanceField[e].id])?this.intermediateDataCheck[this.appearanceField[e].id].includes(this.appearanceField[e].value):this.intermediateDataCheck[this.appearanceField[e].id].toString()===this.appearanceField[e].value.toString())},receiveFormData(){this.intermediateData={userResponse:[]};let e=document.querySelectorAll(".input-field");for(let t of e)if("input"===t.localName){let e={};e[t.id]=t.value,this.intermediateData.userResponse.push(e),this.intermediateDataCheck[t.id]=t.value}else if(t.classList.contains("chips")){let e=t.querySelectorAll(".chip");for(let t of e)this.keyWordList.push(t.textContent)}else if(t.classList.contains("selectMultiple")){let e=[];for(let a of t.querySelectorAll(".selected"))e.push(a.textContent);t.querySelector(".selected").classList.contains("disabled")&&(e=[]);let i={};i[t.id]=e,this.intermediateData.userResponse.push(i),this.intermediateDataCheck[t.id]=t.value}else if(t.classList.contains("selectSingle")){let e=t.querySelector(".selected").textContent||"";t.querySelector(".selected").classList.contains("disabled")&&(e="");let i={};i[t.id]=e,this.intermediateData.userResponse.push(i),this.intermediateDataCheck[t.id]=t.value}else if(t.classList.contains("selectMultipleImage")){let e=[];for(let a of t.querySelectorAll(".selected")){let t={};t["name"]=a.textContent,t["imgUrl"]="img"===a.childNodes[0].localName?a.childNodes[0].attributes["src"].value:"",e.push(t)}t.querySelector(".selected").classList.contains("disabled")&&(e=[]);let i={};i[t.id]=e,this.intermediateData.userResponse.push(i),this.intermediateDataCheck[t.id]=t.value}else if(t.classList.contains("selectSingleImage")){let e={},i=t.querySelector(".selected");i.classList.contains("disabled")||(e.name=i.textContent,e.imgUrl="img"===i.childNodes[0].localName?i.childNodes[0].attributes["src"].value:"");let a={};a[t.id]=e,this.intermediateData.userResponse.push(a),this.intermediateDataCheck[t.id]=t.value}else if(t.classList.contains("form-radio")){let e=t.querySelectorAll(".form-radio-item"),i="";for(let t of e)if(t.checked){i=t.value;break}let a={};a[t.id]=i,this.intermediateData.userResponse.push(a),this.intermediateDataCheck[t.id]=t.value}else if(t.classList.contains("form-checkbox")){let e=t.querySelectorAll(".form-checkbox-item"),i=[];for(let t of e)t.checked&&i.push(t.value);let a={};a[t.id]=i,this.intermediateData.userResponse.push(a),this.intermediateDataCheck[t.id]=t.value}},async submitFormData(){this.createProcess=!0,await E.Z.createDocument(this.$store.state.auth.user.username,this.structureId,ee._.Ready,1,this.intermediateData).then((e=>{this.documentData=e}),(e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),this.$error(X.Z[this.message]||"Что-то пошло не так")}))}},beforeDestroy(){this.formSelect&&this.formSelect.destroy&&this.formSelect.destroy(),this.formChips&&this.formChips.destroy&&this.formChips.destroy()},components:{CreateMessage:Q.Z}},ie=i(89);const ae=(0,ie.Z)(te,[["render",O]]);var se=ae,re=i(7901),le={name:"DocumentCreateView",props:["structureId"],data:()=>({loading:!0,content:[],modal:null}),async mounted(){setTimeout((()=>{this.modal=M.Modal.init(this.$refs.modal)}),0),this.loading=!1},methods:{},beforeDestroy(){this.modal&&this.modal.destroy&&this.modal.destroy()},components:{Sidebar:v.Z,FormGenerator:se,FullScreenLoader:re.Z}};const oe=(0,ie.Z)(le,[["render",g]]);var ne=oe}}]);
//# sourceMappingURL=725.1d1f87c9.js.map